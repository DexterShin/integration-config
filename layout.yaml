# vim: set ts=2 sw=2 et ai foldmethod=indent:
#
# This is the Zuul configuration file for the Wikimedia Foundation.
#
# Zuul configuration is organised in three main sections:
#
# - pipelines: Abstracts incoming Gerrit events and what to report back in Gerrit.
#
# - jobs: Override the pipeline configuration on a per job basis.
#    This is how we specificy behaviour for individual projects and jobs.
#
# - projects: For each project we specify what jobs to run, in what order jobs
#    should depend on each other and for which pipelines the jobs should run.
#
# See also upstream documentation:
# - http://ci.openstack.org/zuul/zuul.html#layout-yaml
# - http://ci.openstack.org/zuul/zuul.html#configuration


pipelines:
  # Terminology:
  # - check: Basic jobs run for all users. Votes V+1
  # - test: More elaborate execution run only after CR+2 or when submitted
  #    by a whitelisted user. Votes V+2.


  # Use this in combination with a 'test' pipeline.
  - name: check
    description: >
      Basic jobs being run for all users. Will vote Verified +1/-1.
    manager: IndependentPipelineManager
    trigger:
      gerrit:
        - event: patchset-created
          # Don't run the check pipeline if the user is allowed to run the test pipeline (bug 43391).
          # TODO: Figure out a way to turn this into a list instead of a single-line regex.
          # TODO: Figure out a way to not have to repeat this from pipeline 'test'.
          # This email_filter and the one for 'test' can be removed once we have fixed bug 45499.
          email_filter:
            - ^(?!(.*?@wikimedia\.org|.*?@wikimedia\.de|l10n-bot@translatewiki\.net|anomie\.wikipedia@gmail\.com|amir\.aharoni@mail\.huji\.ac\.il|hashar@free\.fr|jeroendedauw@gmail\.com|maxsem\.wiki@gmail\.com|mtraceur@member\.fsf\.org|niklas\.laxstrom@gmail\.com|santhosh\.thottingal@gmail\.com|s\.mazeland@xs4all\.nl|stefan\.petrea@gmail\.com|stefan@garage-coding\.com|roan\.kattouw@gmail\.com|krinklemail@gmail\.com|trevorparscal@gmail\.com|inez@wikia-inc\.com|orbit@framezero\.com|david@sheetmusic\.org\.uk|git@samsmith\.io|glaser@hallowelt\.biz|aude\.wiki@gmail\.com|bawolff\+wn@gmail\.com|bryan\.tongminh@gmail\.com|dereckson@espace-win\.org|hartman\.wiki@gmail\.com|hoo@online\.de|codereview@emsenhuber\.ch|daniel@nadir-seen-fire\.com|jamesin\.hongkong\.1@gmail\.com|krenair@gmail\.com|liangent@gmail\.com|mah@everybody\.org|matma\.rex@gmail\.com|raimond\.spekking@gmail\.com|robinp\.1273@gmail\.com|tim@tim-landscheidt\.de|tylerromeo@gmail\.com|umherirrender_de\.wp@web\.de|yuriastrakhan@gmail\.com|yaron57@gmail\.com|markus@semantic-mediawiki\.org|s7eph4n@gmail\.org|wiki@physikerwelt\.de|addshorewiki@gmail\.com|pragun06@gmail\.com|nilesh@nileshc\.com|benestar\.wikimedia@googlemail\.com|mlazowik@gmail\.com|pleasestand@live\.com|legoktm\.wikipedia@gmail\.com|moriel@gmail\.com|d_entous@yahoo\.com|kartik\.mistry@gmail\.com|drenfro@vistaprint\.com|matanya\.moses@gmail\.com|matanya@foss\.co\.il|andrew\.green\.df@gmail\.com|thomaspt@hotmail\.fr|twkozlowski@gmail\.com|yuvipanda@gmail\.com|aarcos\.wiki@gmail\.com|saper@saper\.info|christian@quelltextlich\.at|maria\.pacana@gmail\.com|bebirchall@gmail\.com|shahyar@gmail\.com|federicoleva@tiscali\.it|jack@countervandalism\.net|at\.light@live\.com\.au|jackmcbarn@gmail\.com|platonides@gmail\.com|jarry1250@gmail\.com|admin@alphacorp\.tk|01tonythomas@gmail\.com|benapetr@gmail\.com|pastakhov@yandex\.ru|hardikjuneja\.hj@gmail\.com|siebrand@kitano\.nl|wctaiwan@gmail\.com|ladsgroup@gmail\.com|info@gno\.de|valhallasw@arctus\.nl)).*$
    success-message: 'Basic test build succeeded.'
    success:
      # Only V+1 as these are not elaborate tests. This prevents a change from
      # being merged (requires V+2) before elaborate tests, which vote V+2, have run.
      gerrit:
        verified: 1
    failure-message: 'Basic test build failed.'
    failure:
      gerrit:
        verified: -1

  # Use this instead of 'check' for projects not having a separate 'test' pipeline. Those need to
  # be marked as 'check-only' instead of 'check', because 'check' has a reversed email filter to
  # compensate the 'test' pipeline.
  - name: check-only
    description: Basic jobs being run for all users. Will vote +1.
    manager: IndependentPipelineManager
    trigger:
      gerrit:
        - event: patchset-created
          email_filter:
           - ^(?!l10n-bot@translatewiki\.net).*$
        - event: comment-added
          comment_filter: (?im)^Patch Set \d+:\n\n\s*recheck\.?\s*$
    success-message: 'Basic test build succeeded.'
    success:
      gerrit:
        verified: 1
    failure-message: 'Basic test build failed.'
    failure:
      gerrit:
        verified: -1

  - name: check-voter
    description: >
      Basic jobs for projects without a test pipeline. Will vote +2.
    manager: IndependentPipelineManager
    trigger:
      gerrit:
        - event: patchset-created
        - event: comment-added
          comment_filter: (?im)^Patch Set \d+:\n\n\s*recheck\.?\s*$
    success-message: 'Basic test build succeeded.'
    success:
      gerrit:
        verified: 2
    failure-message: 'Basic test build failed.'
    failure:
      gerrit:
        verified: -1

  # Use this in combination with a check pipeline.
  - name: test
    description: >
      Jobs restricted to trusted users. Will vote +2.
    manager: IndependentPipelineManager
    trigger:
      gerrit:
        - event: patchset-created

          # BEWARE:
          # - Make sure to use non greedy selectors (.*?) and to escape dots: \.
          # - Also update the email_filter of the 'check' pipeline.

          email_filter: &email_whitelist
           - .*?@wikimedia\.org$
           - .*?@wikimedia\.de$

          # WMF staff & contractors:
           - ^aarcos\.wiki@gmail\.com$
           - ^amir\.aharoni@mail\.huji\.ac\.il$
           - ^andrew\.green\.df@gmail\.com$
           - ^anomie\.wikipedia@gmail\.com$
           - ^bawolff\+wn@gmail\.com$
           - ^christian@quelltextlich\.at$
           - ^david@sheetmusic\.org\.uk$ # David Chan
           - ^git@samsmith\.io$ # Sam Smith
           - ^glaser@hallowelt\.biz$
           - ^hashar@free\.fr$
           - ^jeroendedauw@gmail\.com$
           - ^kartik\.mistry@gmail\.com$
           - ^krinklemail@gmail\.com$ # Timo Tijhof
           - ^legoktm\.wikipedia@gmail\.com$  # Kunal Mehta
           - ^maxsem\.wiki@gmail\.com$
           - ^moriel@gmail\.com  # Moriel Schottlender
           - ^mtraceur@member\.fsf\.org$
           - ^niklas\.laxstrom@gmail\.com$
           - ^roan\.kattouw@gmail\.com$
           - ^s\.mazeland@xs4all\.nl$
           - ^santhosh\.thottingal@gmail\.com$
           - ^shahyar@gmail\.com$
           - ^siebrand@kitano\.nl$
           - ^stefan@garage-coding\.com$
           - ^stefan\.petrea@gmail\.com$
           - ^trevorparscal@gmail\.com$
           - ^yuriastrakhan@gmail\.com$
           - ^yuvipanda@gmail\.com$

          # VisualEditor (Wikia)
           - ^inez@wikia-inc\.com$
           - ^orbit@framezero\.com$ # Christian Williams

          # WMDE:
           - ^addshorewiki@gmail\.com$
           - ^aude\.wiki@gmail\.com$
           - ^hoo@online\.de$
           - ^nilesh@nileshc\.com$
           - ^pragun06@gmail\.com$

          # VistaPrint
          # They are heavily using MediaWiki internally and open sourced
          # some of their extensions.  Might wildcard them as well, for
          # now just whitelist Daniel Renfro.
           - ^drenfro@vistaprint\.com$  # AlephNull

          # Trusted long term users:
           - ^admin@alphacorp\.tk$ # Hydriz
           - ^benapetr@gmail\.com$ # petrb
           - ^benestar\.wikimedia@googlemail\.com$
           - ^bryan\.tongminh@gmail\.com$
           - ^codereview@emsenhuber\.ch$
           - ^d_entous@yahoo\.com$
           - ^daniel@nadir-seen-fire\.com$
           - ^dereckson@espace-win\.org$
           - ^federicoleva@tiscali\.it$  # Nemo bis
           - ^hartman\.wiki@gmail\.com$
           - ^info@gno\.de$  # Xqt, Pywikibot maintainer
           - ^jamesin\.hongkong\.1@gmail\.com$  # Mwjames
           - ^jack@countervandalism\.net$ # Jack Phoenix
           - ^jackmcbarn@gmail\.com$ # Jackmcbarn
           - ^jarry1250@gmail\.com$
           - ^krenair@gmail\.com$
           - ^ladsgroup@gmail\.com$  # Pywikibot maintainer
           - ^liangent@gmail\.com$
           - ^mah@everybody\.org$
           - ^markus@semantic-mediawiki\.org$
           - ^matanya\.moses@gmail\.com$
           - ^matanya@foss\.co\.il$
           - ^matma\.rex@gmail\.com$
           - ^mlazowik@gmail\.com$
           - ^pastakhov@yandex\.ru$  # PhpTags maintainer
           - ^platonides@gmail\.com$
           - ^pleasestand@live\.com$
           - ^raimond\.spekking@gmail\.com$
           - ^robinp\.1273@gmail\.com$
           - ^saper@saper\.info$
           - ^s7eph4n@gmail\.org$ # Foxtrott
           - ^thomaspt@hotmail\.fr$
           - ^at\.light@live\.com\.au$ # This, that and the other
           - ^twkozlowski@gmail\.com$
           - ^01tonythomas@gmail\.com$
           - ^tim@tim-landscheidt\.de$
           - ^tylerromeo@gmail\.com$
           - ^umherirrender_de\.wp@web\.de$
           - ^valhallasw@arctus\.nl$  # Merlijn van Deen
           - ^wctaiwan@gmail\.com$
           - ^wiki@physikerwelt\.de$
           - ^yaron57@gmail\.com$

          # OPW interns
           - ^maria\.pacana@gmail\.com$
           - ^bebirchall@gmail\.com$

          # Potential GSoC student for Parsoid
           - ^hardikjuneja\.hj@gmail\.com$

        # Let whitelisted users the ability to reenqueue a change in the test
        # pipeline by simply commenting 'recheck' on a change.
        - event: comment-added
          comment_filter: (?im)^Patch Set \d+:\n\n\s*recheck\.?\s*$
          email_filter: *email_whitelist

    success-message: 'Main test build succeeded.'
    success:
      gerrit:
        verified: 2
    failure-message: 'Main test build failed.'
    failure:
      gerrit:
        verified: -1

  # Actual gate (report/vote in Gerrit)
  # Will auto-submit change on success!
  #
  # WARNING: Also update the "gate" pipeline when changing this one.
  #
  - name: gate-and-submit
    description: >
      Patchsets that have been reviewed. Will be merged by Jenkins if tests pass.
    manager: DependentPipelineManager
    trigger:
      gerrit:
        - event: comment-added
          email_filter:
           - ^(?!l10n-bot@translatewiki\.net).*$
          approval:
            - code-review: 2
    start:
      gerrit:
        verified: 0
    success-message: 'Gate pipeline build succeeded.'
    success:
      gerrit:
        verified: 2
        # Let Zuul merge the change \O/
        submit: true
    failure-message: 'Gate pipeline build failed.'
    failure:
      gerrit:
        verified: -1

  - name: postmerge
    description: Jobs triggered after a change has been merged.
    manager: IndependentPipelineManager
    trigger:
      gerrit:
        - event: change-merged
    success-message: 'Post-merge build succeeded.'
    # Zuul needs at least one option beside --message or it will not report
    # Since Gerrit 2.8, we can vote on closed changes.
    success:
      gerrit:
        verified: 0
    failure-message: 'Post-merge build failed.'
    failure:
      gerrit:
        verified: 0

  # Pipeline reacting whenever a reference is updated
  - name: post
    description: Whenever a reference is updated.
    manager: IndependentPipelineManager
    trigger:
      gerrit:
       - event: ref-updated
         ref: ^(?!(devnull|refs/.*)).*$

  # Pipeline for tags (either a new one or a removal)
  - name: publish
    description: Whenever tags are published.
    manager: IndependentPipelineManager
    trigger:
      gerrit:
       - event: ref-updated
         ref: ^refs/tags/.*$

# Fine tune some jobs
jobs:

  #
  # General
  #

  # Warning: the files regex are using python re.match() wich match at the
  # begining of the filename. '.js$' will only match '.js' not 'foo.js'.
  #
  # See: http://docs.python.org/2/library/re.html#search-vs-match

  # Experiment for analytics/kraken repository
  - name: analytics-kraken
    voting: false

  # Experimental building of Debian packages
  # based on jenkins-debian-glue
  - name: ^.*-debian-glue$
    voting: false

  # The Android app still has plenty of checkstyle issues to fix
  - name: apps-android-wikipedia-maven-checkstyle
    voting: false

  # Work in progress https://gerrit.wikimedia.org/r/110666
  - name: parsoidsvc-debian-glue
    voting: false
    files: 'debian/.*'

  # Parsoid tests overhaul experimentation
  - name: ^parsoidsvc-(deploy|source)-.*
    voting: false

  # Experiment dependencies between repositories
  - name: experiment-gating-dependencies
    voting: false

  # being tested by anomie
  # FIXME should be made voting by default
  - name: ^.*-npmtest$
    voting: false

  - name: ^.*-erblint-HEAD$
    files:
     - '^.*\.erb$'

  - name: ^.*-pplint-HEAD$
    files:
     - '^.*\.pp$'

  - name: '^.*-ruby1.9.3lint$'
    files:
     - '^.*\.rb$'

  # Experiment for bug 48420
  - name: ^.*phpcs-lenient(-HEAD)?$
    voting: true
    files:
     - '^.*\.(php|php5|phtml|inc)$'
  - name: ^.*phpcs-strict(-HEAD)?$
    voting: true
    files:
     - '^.*\.(php|php5|phtml|inc)$'

  - name: mediawiki-core-phpcs-strict-HEAD
    voting: false
  - name: mediawiki-core-phpcs-lenient-HEAD
    voting: false

  # Made voting by default. Jobs now need to be explicitly made non voting
  - name: ^.*-jslint$
    voting: true
    files:
     # Triggers on changes made to .jshintrc, .jshintignore, .jscsrc, *.js and *.json
     - '^(\.js.*|.*\.(js|json)$)'

  - name: ^mediawiki-core-npm$
    files:
     - '^(\.js.*|.*\.(js|json)$)'

  # Some projects which are most probably not passing jshint yet:
  #
  # Tracking bug is 60619
  # https://bugzilla.wikimedia.org/showdependencytree.cgi?id=60619
  #
  - name: mwext-ArticleFeedback-jslint # obsolete - bug 63669
    voting: false
  - name: mwext-ArticleFeedbackv5-jslint  # bug 61588
    voting: false
  - name: mwext-CheckUser-jslint  # bug 61589
    voting: false
  - name: mwext-ClickTracking-jslint  # bug 61591
    voting: false
  - name: mwext-CodeReview-jslint  # bug 61593
    voting: false
  - name: mwext-Collection-jslint  # bug 61594
    voting: false
  - name: mwext-CommunityVoice-jslint  # bug 61595
    voting: false
  - name: mwext-Configure-jslint  # bug 61596
    voting: false
  - name: mwext-ConfirmEdit-jslint  # bug 61597
    voting: false
  - name: mwext-ContributionReporting-jslint  # obsolete - bug 61598
    voting: false
  - name: mwext-ContributionTracking-jslint  # bug 61599
    voting: false
  - name: mwext-CustomUserSignup-jslint  # bug 61600
    voting: false
  - name: mwext-DataTypes-jslint  # bug 61601
    voting: false
  - name: mwext-DismissableSiteNotice-jslint  # bug 61602
    voting: false
  - name: mwext-DonationInterface-jslint
    voting: false
  - name: mwext-Drafts-jslint  # bug 61603
    voting: false
  - name: mwext-DumpHTML-jslint  # bug 61604
    voting: false
  - name: mwext-DynamicSidebar-jslint  # bug 61605
    voting: false
  - name: mwext-FlaggedRevs-jslint # bug 63117
    voting: false
  - name: mwext-JsonData-jslint  # bug 61607
    voting: false
  - name: mwext-LastModified-jslint  # bug 61608
    voting: false
  - name: mwext-Lingo-jslint  # bug 61609
    voting: false
  - name: mwext-MoodBar-jslint  # bug 61612
    voting: false
  - name: mwext-MwEmbedSupport-jslint  # bug 61613
    voting: false
  - name: mwext-Nonlinear-jslint  # bug 61614
    voting: false
  - name: mwext-OATHAuth-jslint  # bug 61617
    voting: false
  - name: mwext-PageTriage-jslint  # bug 61618
    voting: false
  - name: mwext-Quiz-jslint  # bug 61620
    voting: false
  - name: mwext-ReaderFeedback-jslint  # bug 61622
    voting: false
  - name: mwext-ReplaceSet-jslint  # bug 61623
    voting: false
  - name: mwext-ReplaceText-jslint  # bug 61624
    voting: false
  - name: mwext-SVGEdit-jslint  # bug 61625
    voting: false
  - name: mwext-SecurePoll-jslint  # bug 61626
    voting: false
  - name: mwext-SemanticDrilldown-jslint  # bug 61628
    voting: false
  - name: mwext-SemanticExpressiveness-jslint  # bug 61629
    voting: false
  - name: mwext-SemanticForms-jslint  # bug 61630
    voting: false
  - name: mwext-SemanticFormsInputs-jslint  # bug 61631
    voting: false
  - name: mwext-SemanticImageInput-jslint  # bug 61632
    voting: false
  - name: mwext-SemanticMaps-jslint  # bug 61633
    voting: false
  - name: mwext-SemanticResultFormats-jslint  # bug 61634
    voting: false
  - name: mwext-SemanticWatchlist-jslint  # bug 61635
    voting: false
  - name: mwext-SideBarMenu-jslint  # bug 61636
    voting: false
  - name: mwext-Spreadsheet-jslint # bug 63668
    voting: false
  - name: mwext-Survey-jslint  # bug 61637
    voting: false
  - name: mwext-TimedMediaHandler-jslint  # bug 61638
    voting: false
  - name: mwext-TocTree-jslint  # bug 61640
    voting: false
  - name: mwext-TwoFactorAuthentication-jslint  # bug 61641
    voting: false
  - name: mwext-VipsScaler-jslint  # bug 61643
    voting: false
  - name: mwext-WebFonts-jslint  # bug 61644
    voting: false
  - name: mwext-WikiLove-jslint  # bug 61645
    voting: false
  - name: mwext-Wikidata-jslint
    voting: false
  - name: mwext-ZeroRatedMobileAccess-jslint  # bug 61647
    voting: false
  - name: mwext-skins-jslint
    voting: false
  - name: mwext-wikihiero-jslint  # bug 61648
    voting: false
  - name: wikimedia-fundraising-crm-civicrm-jslint
    voting: false
  - name: wikimedia-fundraising-crm-drupal-jslint
    voting: false
  - name: wikimedia-fundraising-crm-jslint
    voting: false
  - name: wikimedia-fundraising-dash-jslint  # bug 65053
    voting: false
  - name: ^.*-jsduck$
    files:
     - '^.*\.(js|json)$'

  - name: ^.*-jsduck-publish$
    files:
     - '^.*\.(js|json)$'

  - name: ^.*-pep8$
    files:
     - '^(.*\.py|tox.ini|.pep8|setup.cfg)$'

  - name: ^.*-pyflakes$
    files:
     - '^(.*\.py|tox.ini|setup.cfg)$'

  - name: analytics-asana-stats-pep8
    voting: false
  - name: analytics-asana-stats-pyflakes
    voting: false
  - name: analytics-check-stats-pep8
    voting: false
  - name: analytics-check-stats-pyflakes
    voting: false
  - name: analytics-editor-geocoding-pep8
    voting: false
  - name: analytics-editor-geocoding-pyflakes
    voting: false
  - name: analytics-gerrit-stats-pep8
    voting: false
  - name: analytics-gerrit-stats-pyflakes
    voting: false
  - name: analytics-geowiki-tox-flake8
    voting: false
  - name: analytics-glass-pep8
    voting: false
  - name: analytics-glass-pyflakes
    voting: false
  - name: analytics-wp-zero-tox-flake8
    voting: false
  - name: analytics-reportcard-pep8
    voting: false
  - name: analytics-reportcard-pyflakes
    voting: false
  - name: mwext-BlameMaps-pep8
    voting: false
  - name: mwext-BlameMaps-pyflakes
    voting: false
  - name: mwext-ConfirmEdit-pep8
    voting: false
  - name: mwext-ConfirmEdit-pyflakes
    voting: false
  - name: mwext-DumpHTML-pep8
    voting: false
  - name: mwext-DumpHTML-pyflakes
    voting: false
  - name: mwext-Offline-pep8
    voting: false
  - name: mwext-Offline-pyflakes
    voting: false
  - name: mwext-OpenStackManager-pep8
    voting: false
  - name: mwext-OpenStackManager-pyflakes
    voting: false
  - name: mwext-SemanticBundle-pep8
    voting: false
  - name: mwext-SemanticBundle-pyflakes
    voting: false
  - name: operations-dumps-pep8
    voting: false
  - name: operations-dumps-pyflakes
    voting: false
  - name: operations-software-pyflakes
    voting: false
  - name: operations-software-redactatron-pep8
    voting: false
  - name: operations-software-redactatron-pyflakes
    voting: false
  - name: mw-tools-codeutils-pep8
    voting: false
  - name: operations-debs-adminbot-pep8
    voting: false
  - name: operations-debs-adminbot-pyflakes
    voting: false
  - name: pywikibot-core-pyflakes
    voting: false
  - name: pywikibot-compat-pyflakes
    voting: false
  - name: wikimedia-fundraising-tools-pep8
    voting: false
  - name: wikimedia-fundraising-tools-pyflakes
    voting: false
  - name: wikimedia-fundraising-SmashPig-pep8
    voting: false
  - name: wikimedia-fundraising-SmashPig-pyflakes
    voting: false

  - name: ^.*-perllint$
    files:
      - '^.*\.(pl|pm)$'

  - name: operations-apache-config-lint
    branch: ^master$

  - name: operations-puppet-puppetlint-lenient
    voting: false
  - name: operations-puppet-puppetlint-strict
    voting: false
  - name: translatewiki-puppetlint-lenient
    voting: false
  - name: translatewiki-puppetlint-strict
    voting: false

  - name: operations-puppet-pep8
    voting: true
    failure-pattern: 'https://integration.wikimedia.org/ci/job/{job.name}/{build.number}/violations/'

  - name: operations-puppet-spec
    voting: false
    success-message: 'Rejoice! Unit tests are passing.'
    failure-message: 'Experimental unit tests, please ignore.'

  - name: operations-software-pep8
    voting: true
    files:
     - '^.*\.py$'

  # PHP CodeSniffer (experimental)
  - name: ^.*-phpcs(-HEAD)?$
    voting: false
    files:
     - '^.*\.(php|php5|phtml|inc)$'
  - name: ^.*-phpcs-HEAD$
    voting: false
    files:
     - '^.*\.(php|php5|phtml|inc)$'

  # Rejecting changes having trailing whitespaces cause too many false
  # positives. So only report the whitespace issues, but don't let it vote.
  - name: ^.*-whitespaces$
    voting: false

  #
  # Individual adjustments
  #

  # being tested out
  - name: apps-android-commons-build
    voting: false

  - name: ^beta-recompile-math-texvc.*
    branch: ^master$

  - name: beta-mediawiki-config-update-eqiad
    branch: ^master$
    success-message: 'Change has been deployed on the EQIAD beta cluster'
    failure-message: 'Failed deployment on the EQIAD beta cluster :-/  Please contact a member of the beta project to fixup the working directory on the destination server.'

  - name: beta-parsoid-update-eqiad
    branch: ^master$
    success-message: 'Change has been deployed on the EQIAD beta cluster'
    failure-message: 'Failed deployment on the EQIAD beta cluster :-/  Please contact a member of the beta project to investigate.'


  - name: integration-docroot-deploy
    branch: ^master$
    success-message: 'Change has been deployed on the server and should be now live on https://integration.wikimedia.org/ or https://doc.wikimedia.org/. Build'
    failure-message: 'FAILED to deploy change. Please contact a member of the continuous integration team to fixup the docroot on the destination server.'

  - name: 'integration-jjb-config-diff'
    success-message: 'Please carefully review the XML difference before deploying/merging your change.'
    failure-message: 'FAILED to compare your patchset with the current configuration version'

  - name: 'integration-zuul-layoutdiff'
    voting: false
    success-message: 'Please carefully review the Zuul layout difference before deploying/merging.'
    failure-message: 'No layout change apparently. Nonetheless, please carefully review before deploying/merging.'

  - name: 'mwext-GuidedTour-doc-publish'
    branch: ^master$

  - name: 'mwext-MultimediaViewer-doc-publish'
    branch: ^master$

  - name: 'mwext-VisualEditor-doc-publish'
    branch: ^master$
  - name: 'mwext-VisualEditor-sync-gerrit'
    branch: ^master$

  - name: labs-migration-assistant-pep8
    voting: true
  - name: labs-migration-assistant-pyflakes
    voting: false  # being worked on

  - name: mwext-EventLogging-pep8
    voting: true
  - name: sartoris-pep8
    voting: true
  - name: sartoris-pyflakes
    voting: true

  # FIXME: work in progress
  - name: sartoris-sphinx-doc
    voting: false

  - name: mw-tools-fluoride-pep8
    voting: true
  - name: mw-tools-fluoride-pyflakes
    voting: true
  - name: mw-tools-release-pep8
    voting: true
  - name: operations-debs-ircecho-pep8
    voting: true

  - name: mw-tools-release-pyflakes
    voting: true
  - name: operations-debs-ircecho-pyflakes
    voting: true

  - name: mediawiki-core-jslint
    # Doesn't work in MediaWiki REL1_19 (bug 44846)
    branch: (?!REL1_19)
  # bug 52120 browsertests for ULS
  - name: mwext-browsertests-UniversalLanguageSelector-phantomjs
    voting: false

  - name: mwext-MobileFrontend-phpcs-HEAD
    voting: true
  - name: mwext-TemplateData-phpcs-HEAD
    voting: true
  - name: mwext-VisualEditor-phpcs-HEAD
    voting: true

  - name: mediawiki-core-doxygen-publish
    branch: ^(master|REL.*)$  # bug 50325

  - name: mediawiki-core-qunit
    # Doesn't work in MediaWiki REL1_19
    # (times out or doesn't start in the first place).
    branch: (?!REL1_19)

  # Experimental
  - name: ^mwext-DataValues-qunit$
    voting: false

  # Bug 65151
  - name: ^mwext-UploadWizard-qunit$
    voting: false

  - name: ^mwext-Wikibase-qunit$
    voting: false

  - name: mediawiki-core-jsduck
    branch: ^(REL1_21|REL1_22|REL1_23|master)$

  - name: mediawiki-core-jsduck-publish
    branch: ^(REL1_21|REL1_22|REL1_23|master)$

  # Bug 61848
  # FlaggablePageTest::testPageDataFromTitle triggers an uncommitted
  # transaction.
  - name: ^mwext-FlaggedRevs-testextensions.*
    voting: false

  # mwext-SideBarMenu-testextensions-master
  - name: ^mwext-SideBarMenu-testextensions-.*
    voting: false

  #
  # Extensions for which parser tests are not passing :-(
  #

  # https://bugzilla.wikimedia.org/49879
  - name: ^mwext-BookManager-testextensions.*
    voting: false

  # https://bugzilla.wikimedia.org/49881
  - name: ^mwext-NaturalLanguageList-testextensions.*
    voting: false

  # https://bugzilla.wikimedia.org/49882
  - name: ^mwext-Transliterator-testextensions.*
    voting: false

  # The JsonData phpunit tests are meant to be independant and
  # do not play well with the MediaWiki phpunit wrapper for now :(
  # See also: https://gerrit.wikimedia.org/r/#/c/52292/
  - name: ^mwext-JsonData-testextensions.*
    voting: false

  # Has an insert that introduce multiple values, that requires SQLite
  # version 3.7.11
  - name: ^mwext-PageTriage-testextensions-master
    voting: false

  # Completely broken test suite
  - name: ^mwext-PagedTiffHandler-testextensions-master.*
    voting: false

  # MediaWiki core regression tests (on merge and per branches):
  - name: ^mediawiki-core-regression-.*
    failure-message: ERROR! It seems this job introduced a regression although it might be caused by a previous commit.
  - name: mediawiki-core-regression-master
    branch: ^master$
  - name: mediawiki-core-regression-REL1_19
    branch: ^REL1_19$
  - name: mediawiki-core-regression-REL1_20
    branch: ^REL1_20$
  - name: mediawiki-core-regression-REL1_21
    branch: ^REL1_21
  - name: mediawiki-core-regression-REL1_22
    branch: ^REL1_22
  - name: mediawiki-core-regression-REL1_23
    branch: ^REL1_23

  - name: mediawiki-core-regression-hhvm-REL1_23
    branch: ^REL1_23$
    voting: false
  - name: mediawiki-core-regression-hhvm-master
    branch: ^master$
    voting: false

  # Extensions for which tests are non-functional or absent:
  - name: ^mwext-EtherEditor-testextensions.*
    voting: false

  # Being worked on with Nik
  - name: mwext-browsertests-CirrusSearch-phantomjs
    voting: false

  - name: mwext-UploadWizard-pep8
    voting: true
  - name: mwext-UploadWizard-pyflakes
    voting: true

  - name: operations-puppet-doc
    success-message: 'Documentation published on https://doc.wikimedia.org/puppet/. Build'

  - name: wikimedia-fundraising-tools-yamllint
    voting: false
  - name: wikimedia-fundraising-SmashPig-sphinx-doc
    voting: false

  - name: pywikibot-core-tox-flake8
    voting: false

  - name: pywikibot-compat-pep8
    voting: true
  - name: pywikibot-core-pep8
    voting: true

  # Work in progress (bug 54384)
  - name: qa-browsertests-build
    voting: false

  - name: mediawiki-vagrant-erblint-HEAD
    voting: false
  - name: mediawiki-vagrant-puppetlint-lenient
    voting: false
  - name: mediawiki-vagrant-puppetlint-strict
    voting: false


project-templates:

  # Template for MediaWiki extensions.
  # Does run the unit tests on 'test' and 'gate-and-submit'
  - name: extension-unittests
    check:
     - 'mwext-{extname}-jslint'
     - 'mwext-{extname}-lint'
    test:
     - 'mwext-{extname}-jslint'
     - 'mwext-{extname}-lint':
       - 'mwext-{extname}-testextensions-master'
    gate-and-submit:
     - 'mwext-{extname}-jslint'
     - 'mwext-{extname}-lint':
       - 'mwext-{extname}-testextensions-master'

  # Template for MediaWiki extensions.
  # No unit tests but vote on linting.
  - name: extension-checks
    check-only:
     - 'mwext-{extname}-jslint'
     - 'mwext-{extname}-lint'
    gate-and-submit:
     - 'mwext-{extname}-jslint'
     - 'mwext-{extname}-lint'

  - name: python
    check-voter:
      - '{prefix}-pep8'
      - '{prefix}-pyflakes'
      - '{prefix}-sphinx-doc'
    gate-and-submit:
      - '{prefix}-pep8'
      - '{prefix}-pyflakes'
      - '{prefix}-sphinx-doc'

  - name: python-lint
    check-voter:
      - '{prefix}-pep8'
      - '{prefix}-pyflakes'
    gate-and-submit:
      - '{prefix}-pep8'
      - '{prefix}-pyflakes'

  - name: puppet
    # FIXME add merge probably
    # voting since we usually do not have any unit tests
    check-voter:
      - 'operations-puppet-{module}-erblint-HEAD'
      - 'operations-puppet-{module}-pplint-HEAD'

# Register the Gerrit project name, apply them pipelines that in turn trigger
# a set of jobs.
projects:
  - name: gerrit

  - name: integration/jenkins
    check-voter:
      - 'integration-jenkins-pep8'
      - 'integration-jenkins-phplint'
      - 'integration-jenkins-pyflakes'
    gate-and-submit:
      - 'integration-jenkins-pep8'
      - 'integration-jenkins-phplint'
      - 'integration-jenkins-pyflakes'

  - name: integration/jenkins-job-builder-config
    # FIXME: make this 'check' whenever we have integration tests
    check-voter:
      - integration-jjb-config-yamllint
      - integration-jjb-config-test
      - integration-jjb-config-diff
    gate-and-submit:
      - integration-jjb-config-yamllint
      - integration-jjb-config-test

  - name: integration/zuul-config
    # FIXME: make this 'check' whenever we have integration tests
    check-voter:
      - integration-zuul-config-yamllint
      - integration-zuul-layoutvalidation
      - integration-zuul-layoutdiff
    gate-and-submit:
      - integration-zuul-config-yamllint
      - integration-zuul-layoutvalidation
      - integration-zuul-layoutdiff

  - name: mediawiki/core
    check:
      - mediawiki-core-whitespaces
      - mediawiki-core-phpcs-lenient-HEAD
      - mediawiki-core-phpcs-strict-HEAD
      - mediawiki-core-jslint
      - mediawiki-core-lint
    test:
      - mediawiki-core-phpcs-lenient-HEAD
      - mediawiki-core-phpcs-strict-HEAD
      - mediawiki-core-jsduck
      - mediawiki-core-npm
      - mediawiki-core-lint:
        - mediawiki-core-phpunit-databaseless
        - mediawiki-core-install-sqlite:
          - mediawiki-core-qunit
          - mediawiki-core-phpunit-api
          - mediawiki-core-phpunit-misc
          - mediawiki-core-phpunit-parser
    gate-and-submit:
#      - mediawiki-core-phpcs-lenient-HEAD
#      - mediawiki-core-phpcs-strict-HEAD
      - mediawiki-core-jsduck
      - mediawiki-core-npm
      - mediawiki-core-lint:
        - mediawiki-core-phpunit-databaseless
        - mediawiki-core-install-sqlite:
          - mediawiki-core-qunit
          - mediawiki-core-phpunit-api
          - mediawiki-core-phpunit-misc
          - mediawiki-core-phpunit-parser
    postmerge:
      - mediawiki-core-jsduck-publish
      - mediawiki-core-regression-master
      - mediawiki-core-regression-REL1_19
      - mediawiki-core-regression-REL1_20
      - mediawiki-core-regression-REL1_21
      - mediawiki-core-regression-REL1_22
      - mediawiki-core-regression-REL1_23
      - mediawiki-core-regression-hhvm-REL1_23
      - mediawiki-core-regression-hhvm-master
      #- mediawiki-core-regression-phpcs-HEAD
      - mediawiki-core-doxygen-publish
    publish:
      - mediawiki-core-release

  - name: analytics/asana-stats
    template:
      - name: 'python-lint'
        prefix: 'analytics-asana-stats'

  - name: analytics/check-stats
    template:
      - name: 'python-lint'
        prefix: 'analytics-check-stats'

  - name: analytics/editor-geocoding
    template:
      - name: 'python-lint'
        prefix: 'analytics-editor-geocoding'

  - name: analytics/geowiki
    check-voter:
     - analytics-geowiki-tox-flake8
    gate-and-submit:
     - analytics-geowiki-tox-flake8

  - name: analytics/gerrit-stats
    template:
      - name: 'python-lint'
        prefix: 'analytics-gerrit-stats'

  - name: analytics/glass
    template:
      - name: 'python-lint'
        prefix: 'analytics-glass'

  - name: analytics/kraken
    test:
      - analytics-kraken

  - name: analytics/reportcard
    template:
      - name: 'python-lint'
        prefix: 'analytics-reportcard'

  - name: analytics/libanon
    test:
     - analytics-libanon
    gate-and-submit:
     - analytics-libanon
    postmerge:
     - analytics-libanon

  - name: analytics/limn-mobile-data
    check-voter:
     - analytics-limn-mobile-data-tox-flake8
    gate-and-submit:
     - analytics-limn-mobile-data-tox-flake8

  - name: analytics/multimedia
    check-voter:
     - analytics-multimedia-tox-flake8
    gate-and-submit:
     - analytics-multimedia-tox-flake8

  - name: analytics/udp-filters
    test:
     - analytics-udp-filters
    gate-and-submit:
     - analytics-udp-filters
    postmerge:
     - analytics-udp-filters

  - name: analytics/webstatscollector
    test:
     - analytics-webstatscollector
    gate-and-submit:
     - analytics-webstatscollector
    postmerge:
     - analytics-webstatscollector

  - name: analytics/wikistats
    test:
     - analytics-wikistats
    gate-and-submit:
     - analytics-wikistats
    postmerge:
     - analytics-wikistats

  - name: analytics/wikimetrics
    check-voter:
     - analytics-wikimetrics-tox-flake8
    gate-and-submit:
     - analytics-wikimetrics-tox-flake8

  - name: analytics/wp-zero
    check-voter:
     - analytics-wp-zero-tox-flake8
    gate-and-submit:
     - analytics-wp-zero-tox-flake8

  - name: apps/android/commons
    test:
      - apps-android-commons-build
    gate-and-submit:
      - apps-android-commons-build

  - name: apps/android/wikipedia
    check-voter:
      - apps-android-wikipedia-jslint
      - apps-android-wikipedia-tox-flake8
      - apps-android-wikipedia-maven-checkstyle
    gate-and-submit:
      - apps-android-wikipedia-jslint
      - apps-android-wikipedia-tox-flake8
      - apps-android-wikipedia-maven-checkstyle

  - name: labs/incubator
    check-voter:
     - labs-incubator-phplint
    gate-and-submit:
     - labs-incubator-phplint

  - name: labs/migration-assistant
    template:
      - name: 'python-lint'
        prefix: 'labs-migration-assistant'

  - name: labs/nagios-builder
    template:
      - name: 'python-lint'
        prefix: 'labs-nagios-builder'

  - name: labs/toollabs
    test:
     - labs-toollabs-debian-glue

  - name: labs/tools/grrrit
    check-voter:
     - labs-tools-grrrit-jslint
     - labs-tools-grrrit-yamllint
    gate-and-submit:
     - labs-tools-grrrit-jslint
     - labs-tools-grrrit-yamllint

  - name: integration/docroot
    check-voter:
     - integration-docroot-phplint
     - integration-docroot-jslint
    test:
     - integration-docroot-phplint
     - integration-docroot-jslint
    gate-and-submit:
     - integration-docroot-phplint
     - integration-docroot-jslint
    postmerge:
     - integration-docroot-deploy

  - name: mediawiki/ruby/api
    check-voter:
     - mediawiki-ruby-api-ruby1.9.3lint
    gate-and-submit:
     - mediawiki-ruby-api-ruby1.9.3lint
    postmerge:
     - mediawiki-ruby-api-gembuild

  - name: mediawiki/selenium
    check-voter:
     - mediawiki-selenium-ruby1.9.3lint
    gate-and-submit:
     - mediawiki-selenium-ruby1.9.3lint
    postmerge:
     - mediawiki-selenium-gembuild

  - name: mediawiki/skins/erudite
    check-voter:
     - mw-skins-erudite-phplint
    gate-and-submit:
     - mw-skins-erudite-phplint

  - name: mediawiki/skins/mediawiki-strapping
    check-voter:
     - mw-skins-mediawiki-strapping-phplint
    gate-and-submit:
     - mw-skins-mediawiki-strapping-phplint

  - name: mediawiki/skins/webplatform
    check-voter:
     - mw-skins-webplatform-phplint
    gate-and-submit:
     - mw-skins-webplatform-phplint

  - name: mediawiki/tools/code-utils
    check-voter:
     - mw-tools-codeutils-pep8
     - mw-tools-codeutils-pyflakes
     - mw-tools-codeutils-phplint
    gate-and-submit:
     - mw-tools-codeutils-pep8
     - mw-tools-codeutils-pyflakes
     - mw-tools-codeutils-phplint

  - name: mediawiki/tools/dippybird
    check-voter:
     - mw-tools-dippybird-phplint
    gate-and-submit:
     - mw-tools-dippybird-phplint

  - name: mediawiki/tools/fluoride
    template:
      - name: 'python-lint'
        prefix: 'mw-tools-fluoride'

  - name: mediawiki/tools/release
    test:
      - mw-tools-release-phplint
      - mw-tools-release-tox-flake8
      - mw-tools-release-tox-py27
    gate-and-submit:
      - mw-tools-release-phplint
      - mw-tools-release-tox-flake8
      - mw-tools-release-tox-py27

  - name: mediawiki/tools/releng
    test:
      - mw-tools-releng-tox-doc
    gate-and-submit:
      - mw-tools-releng-tox-doc
    postmerge:
      - mw-tools-releng-tox-doc-publish

  - name: mediawiki/tools/scap
    test:
     - mw-tools-scap-tox-doc
     - mw-tools-scap-tox-flake8
     - mw-tools-scap-tox-py27
    gate-and-submit:
     - mw-tools-scap-tox-doc
     - mw-tools-scap-tox-flake8
     - mw-tools-scap-tox-py27
    postmerge:
     - mw-tools-scap-tox-doc-publish

  - name: mediawiki/vagrant
    check-voter:
      - mediawiki-vagrant-puppet-validate
      - mediawiki-vagrant-erblint-HEAD
      - mediawiki-vagrant-puppetlint-lenient
      - mediawiki-vagrant-puppetlint-strict
    gate-and-submit:
      - mediawiki-vagrant-erblint-HEAD
      - mediawiki-vagrant-puppetlint-lenient
      - mediawiki-vagrant-puppetlint-strict
      - mediawiki-vagrant-puppet-validate
    postmerge:
      - mediawiki-vagrant-puppet-doc

  - name: operations/apache-config
    # FIXME: convert back to "check" pipeline whenever we have
    # integration tests
    test:
      - operations-apache-config-lint
    gate-and-submit:
      - operations-apache-config-lint

  - name: operations/debs/adminbot
    template:
      - name: 'python-lint'
        prefix: 'operations-debs-adminbot'

  - name: operations/debs/archiva
    test:
     - operations-debs-archiva-debian-glue

  - name: operations/debs/buck
    test:
     - operations-debs-buck-debian-glue

  - name: operations/debs/ganglia
    test:
     - operations-debs-ganglia-debian-glue

  - name: operations/debs/gerrit
    test:
     - operations-debs-gerrit-debian-glue

  - name: operations/debs/git-fat
    test:
     - operations-debs-git-fat-debian-glue

  - name: operations/debs/ircecho
    template:
      - name: 'python-lint'
        prefix: 'operations-debs-ircecho'

  - name: operations/debs/jenkins-debian-glue
    test:
     - operations-debs-jenkins-debian-glue-debian-glue

  - name: operations/debs/kafka
    test:
     - operations-debs-kafka-debian-glue

  - name: operations/debs/latexml
    test:
     - operations-debs-latexml-debian-glue

  - name: operations/debs/pybal
    test:
     - operations-debs-pybal-debian-glue

  - name: operations/debs/varnish
    test:
     - operations-debs-varnish-debian-glue

  - name: operations/debs/vips
    test:
     - operations-debs-vips-debian-glue

  - name: operations/debs/wikistats
    check:
      - operations-debs-wikistats-phplint
    test:
     - operations-debs-wikistats-phplint
     - operations-debs-wikistats-debian-glue
    gate-and-submit:
     - operations-debs-wikistats-phplint
     - operations-debs-wikistats-debian-glue

  - name: operations/debs/lucene-search-2
    test:
     - lucene-search-2-antbuild
    gate-and-submit:
     - lucene-search-2-antbuild

  - name: operations/dns
    check-voter:
      - operations-dns-lint

  - name: operations/dumps
    check-voter:
      - operations-dumps-pep8
      - operations-dumps-pyflakes
    gate-and-submit:
      - operations-dumps-pep8
      - operations-dumps-pyflakes

  - name: operations/mediawiki-config
    check:
      - operations-mw-config-phplint
    test:
      - operations-mw-config-phplint
      - operations-mw-config-tests
    gate-and-submit:
      - operations-mw-config-phplint
      - operations-mw-config-tests
    postmerge:
      - beta-mediawiki-config-update-eqiad

  - name: operations/puppet
    # Only lint on submission for now, that will be voting
    check:
      - operations-puppet-erblint-HEAD
      - operations-puppet-puppetlint-lenient
      - operations-puppet-puppetlint-strict
      - operations-puppet-pep8
      - operations-puppet-typos
      - operations-puppet-validate
    # Same for trusted user
    test:
      # rspec unit testing!
      - operations-puppet-spec
      - operations-puppet-tox-data_admin_lint
      # Same as `check` pipeline:
      - operations-puppet-erblint-HEAD
      - operations-puppet-puppetlint-lenient
      - operations-puppet-puppetlint-strict
      - operations-puppet-pep8
      - operations-puppet-typos
      - operations-puppet-validate
    postmerge:
      - operations-puppet-doc

  - name: operations/puppet/cdh4
    template:
      - name: puppet
        module: cdh4

  - name: operations/puppet/jmxtrans
    template:
      - name: puppet
        module: jmxtrans

  - name: operations/puppet/kafka
    template:
      - name: puppet
        module: kafka

  - name: operations/puppet/mariadb
    template:
      - name: puppet
        module: mariadb

  - name: operations/puppet/nginx
    template:
      - name: puppet
        module: nginx

  - name: operations/puppet/varnish
    template:
      - name: puppet
        module: varnish

  - name: operations/puppet/wikimetrics
    template:
      - name: puppet
        module: wikimetrics

  - name: operations/puppet/zookeeper
    template:
      - name: puppet
        module: zookeeper

  - name: operations/software
    check-voter:
      - operations-software-pep8
      - operations-software-pyflakes

  - name: operations/software/redactatron
    check-voter:
      - operations-software-redactatron-pep8
      - operations-software-redactatron-pyflakes
    gate-and-submit:
      - operations-software-redactatron-pep8
      - operations-software-redactatron-pyflakes

  - name: translatewiki
    check-only:
      - translatewiki-phplint
      - translatewiki-puppet-validate
      - translatewiki-puppetlint-lenient
      - translatewiki-puppetlint-strict
      - translatewiki-shelllint
      - translatewiki-yamllint
    gate-and-submit:
      - translatewiki-phplint
      - translatewiki-puppet-validate
      - translatewiki-puppetlint-lenient
      - translatewiki-puppetlint-strict
      - translatewiki-shelllint
      - translatewiki-yamllint

  - name: wikimedia/bugzilla/wikibugs
    # Only lint on submission for now, that will be voting
    check-voter:
      - wikimedia-bugzilla-wikibugs-perllint

  - name: wikimedia/fundraising/dash
    check-voter:
      - wikimedia-fundraising-dash-jslint
      - wikimedia-fundraising-dash-npm
    gate-and-submit:
      - wikimedia-fundraising-dash-jslint
      - wikimedia-fundraising-dash-npm

  - name: wikimedia/fundraising/tools
    check-voter:
      - wikimedia-fundraising-tools-jslint
      - wikimedia-fundraising-tools-pep8
      - wikimedia-fundraising-tools-pyflakes
      - wikimedia-fundraising-tools-yamllint
    gate-and-submit:
      - wikimedia-fundraising-tools-jslint
      - wikimedia-fundraising-tools-pep8
      - wikimedia-fundraising-tools-pyflakes
      - wikimedia-fundraising-tools-yamllint

  - name: wikimedia/fundraising/crm
    check-voter:
      - wikimedia-fundraising-crm-jslint
      - wikimedia-fundraising-crm-phplint
    gate-and-submit:
      - wikimedia-fundraising-crm-jslint
      - wikimedia-fundraising-crm-phplint

  - name: wikimedia/fundraising/crm/civicrm
    check-voter:
      - wikimedia-fundraising-crm-civicrm-jslint
      - wikimedia-fundraising-crm-civicrm-phplint
    gate-and-submit:
      - wikimedia-fundraising-crm-civicrm-jslint
      - wikimedia-fundraising-crm-civicrm-phplint

  - name: wikimedia/fundraising/crm/drupal
    check-voter:
      - wikimedia-fundraising-crm-drupal-jslint
      - wikimedia-fundraising-crm-drupal-phplint
    gate-and-submit:
      - wikimedia-fundraising-crm-drupal-jslint
      - wikimedia-fundraising-crm-drupal-phplint

  - name: wikimedia/fundraising/SmashPig
    check-voter:
      - wikimedia-fundraising-SmashPig-pep8
      - wikimedia-fundraising-SmashPig-phplint
      - wikimedia-fundraising-SmashPig-pyflakes
      - wikimedia-fundraising-SmashPig-sphinx-doc
    gate-and-submit:
      - wikimedia-fundraising-SmashPig-pep8
      - wikimedia-fundraising-SmashPig-phplint
      - wikimedia-fundraising-SmashPig-pyflakes
      - wikimedia-fundraising-SmashPig-sphinx-doc

  - name: wikimedia/wikimania-scholarships
    check:
     - wikimedia-wikimania-scholarships-jslint
     - wikimedia-wikimania-scholarships-phplint
    test:
     - wikimedia-wikimania-scholarships-jslint
     - wikimedia-wikimania-scholarships-phplint
     - wikimedia-wikimania-scholarships-phpunit
    gate-and-submit:
     - wikimedia-wikimania-scholarships-jslint
     - wikimedia-wikimania-scholarships-phplint
     - wikimedia-wikimania-scholarships-phpunit

#### MediaWiki extensions ######################################

  - name: mediawiki/extensions/AbuseFilter
    template:
      - name: extension-unittests
        extname: AbuseFilter

  - name: mediawiki/extensions/AccountAudit
    template:
      - name: extension-checks
        extname: AccountAudit

  - name: mediawiki/extensions/ActiveAbstract
    template:
      - name: extension-unittests
        extname: ActiveAbstract

  - name: mediawiki/extensions/AdminLinks
    template:
      - name: extension-checks
        extname: AdminLinks

  - name: mediawiki/extensions/Agora
    template:
      - name: extension-checks
        extname: Agora

  - name: mediawiki/extensions/AntiBot
    template:
      - name: extension-checks
        extname: AntiBot

  - name: mediawiki/extensions/AntiSpoof
    template:
      - name: extension-unittests
        extname: AntiSpoof

  - name: mediawiki/extensions/Annotator
    template:
      - name: extension-checks
        extname: Annotator

  - name: mediawiki/extensions/APC
    template:
      - name: extension-checks
        extname: APC

  - name: mediawiki/extensions/ApprovedRevs
    template:
      - name: extension-checks
        extname: ApprovedRevs

  - name: mediawiki/extensions/ArticleFeedback
    template:
      - name: extension-checks
        extname: ArticleFeedback

  - name: mediawiki/extensions/ArticleFeedbackv5
    template:
      - name: extension-checks
        extname: ArticleFeedbackv5

  - name: mediawiki/extensions/ApiSandbox
    template:
      - name: extension-checks
        extname: ApiSandbox

  - name: mediawiki/extensions/Arrays
    template:
      - name: extension-unittests
        extname: Arrays

  - name: mediawiki/extensions/Babel
    template:
      - name: extension-checks
        extname: Babel

  - name: mediawiki/extensions/BetaFeatures
    template:
      - name: extension-unittests
        extname: BetaFeatures

  - name: mediawiki/extensions/BlameMaps
    check-only:
      - mwext-BlameMaps-jslint
      - mwext-BlameMaps-lint
      - mwext-BlameMaps-pep8
      - mwext-BlameMaps-pyflakes
    gate-and-submit:
      - mwext-BlameMaps-jslint
      - mwext-BlameMaps-lint
      - mwext-BlameMaps-pep8
      - mwext-BlameMaps-pyflakes

  - name: mediawiki/extensions/BookManager
    template:
      - name: extension-unittests
        extname: BookManager

  - name: mediawiki/extensions/BookManagerv2
    template:
      - name: extension-checks
        extname: BookManagerv2

  - name: mediawiki/extensions/Calendar
    template:
      - name: extension-checks
        extname: Calendar

  - name: mediawiki/extensions/Campaigns
    template:
      - name: extension-unittests
        extname: Campaigns

  - name: mediawiki/extensions/Capiunto
    template:
      - name: extension-unittests
        extname: Capiunto

  - name: mediawiki/extensions/CategoryTagSorter
    template:
      - name: extension-unittests
        extname: CategoryTagSorter

  - name: mediawiki/extensions/CategoryTree
    template:
      - name: extension-checks
        extname: CategoryTree

  - name: mediawiki/extensions/CharInsert
    template:
      - name: extension-checks
        extname: CharInsert

  - name: mediawiki/extensions/CheckUser
    template:
      - name: extension-checks
        extname: CheckUser

  - name: mediawiki/extensions/Cite
    template:
      - name: extension-unittests
        extname: Cite

  - name: mediawiki/extensions/cldr
    check-only:
      - mwext-cldr-phpcs-strict-HEAD # Experiment, bug 48420
      - mwext-cldr-jslint
      - mwext-cldr-lint
    gate-and-submit:
      - mwext-cldr-phpcs-strict-HEAD # Experiment, bug 48420
      - mwext-cldr-jslint
      - mwext-cldr-lint:
        - mwext-cldr-testextensions-master

  - name: mediawiki/extensions/CentralAuth
    template:
      - name: extension-checks
        extname: CentralAuth

  - name: mediawiki/extensions/CentralNotice
    template:
      - name: extension-unittests
        extname: CentralNotice

  - name: mediawiki/extensions/CirrusSearch
    check:
     - mwext-CirrusSearch-jslint
     - mwext-CirrusSearch-lint
     - mwext-CirrusSearch-ruby1.9.3lint
    test:
     - mwext-CirrusSearch-jslint
     - mwext-CirrusSearch-lint:
       - mwext-CirrusSearch-testextensions-master
     - mwext-CirrusSearch-ruby1.9.3lint
     - mwext-browsertests-CirrusSearch-phantomjs  # experimental
    gate-and-submit:
     - mwext-CirrusSearch-jslint
     - mwext-CirrusSearch-lint:
       - mwext-CirrusSearch-testextensions-master
     - mwext-CirrusSearch-ruby1.9.3lint

  - name: mediawiki/extensions/CleanChanges
    template:
      - name: extension-checks
        extname: CleanChanges

  - name: mediawiki/extensions/ClickTracking
    template:
      - name: extension-checks
        extname: ClickTracking

  - name: mediawiki/extensions/ClientSide
    template:
      - name: extension-checks
        extname: ClientSide

  - name: mediawiki/extensions/CodeEditor
    template:
      - name: extension-checks
        extname: CodeEditor

  - name: mediawiki/extensions/CodeReview
    template:
      - name: extension-unittests
        extname: CodeReview

  - name: mediawiki/extensions/Collection
    template:
      - name: extension-unittests
        extname: Collection

  - name: mediawiki/extensions/Collection/OfflineContentGenerator
    check:
      - mwext-Collection-OfflineContentGenerator-jslint
    test:
      - mwext-Collection-OfflineContentGenerator-jslint
      - mwext-Collection-OfflineContentGenerator-npm
    gate-and-submit:
      - mwext-Collection-OfflineContentGenerator-jslint
      - mwext-Collection-OfflineContentGenerator-npm

  - name: mediawiki/extensions/Collection/OfflineContentGenerator/bundler
    check:
      - mwext-Collection-OfflineContentGenerator-bundler-jslint
    test:
      - mwext-Collection-OfflineContentGenerator-bundler-jslint
      - mwext-Collection-OfflineContentGenerator-bundler-npm
    gate-and-submit:
      - mwext-Collection-OfflineContentGenerator-bundler-jslint
      - mwext-Collection-OfflineContentGenerator-bundler-npm

  - name: mediawiki/extensions/Collection/OfflineContentGenerator/latex_renderer
    check:
      - mwext-Collection-OfflineContentGenerator-latex_renderer-jslint
    test:
      - mwext-Collection-OfflineContentGenerator-latex_renderer-jslint
      - mwext-Collection-OfflineContentGenerator-latex_renderer-npm
    gate-and-submit:
      - mwext-Collection-OfflineContentGenerator-latex_renderer-jslint
      - mwext-Collection-OfflineContentGenerator-latex_renderer-npm

  - name: mediawiki/extensions/Collection/OfflineContentGenerator/text_renderer
    check:
      - mwext-Collection-OfflineContentGenerator-text_renderer-jslint
    test:
      - mwext-Collection-OfflineContentGenerator-text_renderer-jslint
      - mwext-Collection-OfflineContentGenerator-text_renderer-npm
    gate-and-submit:
      - mwext-Collection-OfflineContentGenerator-text_renderer-jslint
      - mwext-Collection-OfflineContentGenerator-text_renderer-npm

  - name: mediawiki/extensions/CommonsMetadata
    template:
      - name: extension-unittests
        extname: CommonsMetadata

  - name: mediawiki/extensions/Configure
    template:
      - name: extension-checks
        extname: Configure

  # FIXME: it has pep8
  - name: mediawiki/extensions/ConfirmEdit
    check-only:
      - mwext-ConfirmEdit-jslint
      - mwext-ConfirmEdit-lint
      - mwext-ConfirmEdit-pep8
      - mwext-ConfirmEdit-pyflakes
    gate-and-submit:
      - mwext-ConfirmEdit-jslint
      - mwext-ConfirmEdit-lint
      - mwext-ConfirmEdit-pep8
      - mwext-ConfirmEdit-pyflakes

  - name: mediawiki/extensions/ContentTranslation
    check-only:
      - mwext-ContentTranslation-phpcs-strict-HEAD # Experiment, bug 48420
      - mwext-ContentTranslation-jslint
      - mwext-ContentTranslation-lint
      - mwext-ContentTranslation-ruby1.9.3lint
      - mwext-ContentTranslation-yamllint
    gate-and-submit:
      - mwext-ContentTranslation-phpcs-strict-HEAD # Experiment, bug 48420
      - mwext-ContentTranslation-jslint
      - mwext-ContentTranslation-lint
      - mwext-ContentTranslation-ruby1.9.3lint
      - mwext-ContentTranslation-yamllint

  - name: mediawiki/extensions/ContributionScores
    template:
      - name: extension-checks
        extname: ContributionScores

  - name: mediawiki/extensions/CommonMessages
    template:
      - name: extension-unittests
        extname: CommonMessages

  - name: mediawiki/extensions/CommunityApplications
    template:
      - name: extension-checks
        extname: CommunityApplications

  - name: mediawiki/extensions/CommunityHiring
    template:
      - name: extension-checks
        extname: CommunityHiring

  - name: mediawiki/extensions/CommunityVoice
    template:
      - name: extension-checks
        extname: CommunityVoice

  - name: mediawiki/extensions/ContactPage
    template:
      - name: extension-checks
        extname: ContactPage

  - name: mediawiki/extensions/ContactPageFundraiser
    template:
      - name: extension-checks
        extname: ContactPageFundraiser

  - name: mediawiki/extensions/FundraisingChart
    template:
      - name: extension-checks
        extname: FundraisingChart

  - name: mediawiki/extensions/ContributionReporting
    template:
      - name: extension-checks
        extname: ContributionReporting

  - name: mediawiki/extensions/ContributionTracking
    template:
      - name: extension-unittests
        extname: ContributionTracking

  - name: mediawiki/extensions/ConventionExtension
    template:
      - name: extension-unittests
        extname: ConventionExtension

  - name: mediawiki/extensions/WikimediaEvents
    template:
      - name: extension-checks
        extname: WikimediaEvents

  - name: mediawiki/extensions/CreditsSource
    template:
      - name: extension-checks
        extname: CreditsSource

  - name: mediawiki/extensions/CustomData
    template:
      - name: extension-checks
        extname: CustomData

  - name: mediawiki/extensions/CustomUserSignup
    template:
      - name: extension-checks
        extname: CustomUserSignup

  - name: mediawiki/extensions/DataValues
    check:
     - mwext-DataValues-jslint
     - mwext-DataValues-lint
    test:
     - mwext-DataValues-jslint
     - mwext-DataValues-lint:
       - mwext-DataValues-testextensions-master
       - mwext-DataValues-qunit
    gate-and-submit:
     - mwext-DataValues-jslint
     - mwext-DataValues-lint:
       - mwext-DataValues-testextensions-master
       - mwext-DataValues-qunit

  - name: mediawiki/extensions/DataTypes
    template:
      - name: extension-unittests
        extname: DataTypes

  - name: mediawiki/extensions/DonationInterface
    check:
      - mwext-DonationInterface-jslint
      - mwext-DonationInterface-lint
    test:
      - mwext-DonationInterface-jslint
      - mwext-DonationInterface-lint
      - mwext-DonationInterface-testextensions-master
    gate-and-submit:
      - mwext-DonationInterface-jslint
      - mwext-DonationInterface-lint
      - mwext-DonationInterface-testextensions-master

  - name: mediawiki/extensions/DeleteBatch
    template:
      - name: extension-checks
        extname: DeleteBatch

  - name: mediawiki/extensions/Diff
    template:
      - name: extension-unittests
        extname: Diff

  - name: mediawiki/extensions/DisableAccount
    template:
      - name: extension-checks
        extname: DisableAccount

  - name: mediawiki/extensions/Disambiguator
    template:
      - name: extension-checks
        extname: Disambiguator

  - name: mediawiki/extensions/DiscussionThreading
    template:
      - name: extension-checks
        extname: DiscussionThreading

  - name: mediawiki/extensions/DismissableSiteNotice
    template:
      - name: extension-checks
        extname: DismissableSiteNotice

  - name: mediawiki/extensions/DoubleWiki
    template:
      - name: extension-checks
        extname: DoubleWiki

  - name: mediawiki/extensions/Drafts
    template:
      - name: extension-unittests
        extname: Drafts

  - name: mediawiki/extensions/DynamicSidebar
    template:
      - name: extension-checks
        extname: DynamicSidebar

  - name: mediawiki/extensions/DumpHTML
    check-only:
      - mwext-DumpHTML-jslint
      - mwext-DumpHTML-lint
      - mwext-DumpHTML-pep8
      - mwext-DumpHTML-pyflakes
    gate-and-submit:
      - mwext-DumpHTML-jslint
      - mwext-DumpHTML-lint
      - mwext-DumpHTML-pep8
      - mwext-DumpHTML-pyflakes

  - name: mediawiki/extensions/E3Experiments
    template:
      - name: extension-unittests
        extname: E3Experiments

  - name: mediawiki/extensions/Echo
    template:
      - name: extension-unittests
        extname: Echo

  - name: mediawiki/extensions/Editcount
    template:
      - name: extension-checks
        extname: Editcount

  - name: mediawiki/extensions/EditPageTracking
    template:
      - name: extension-checks
        extname: EditPageTracking

  - name: mediawiki/extensions/EducationProgram
    template:
      - name: extension-unittests
        extname: EducationProgram

  - name: mediawiki/extensions/EmailCapture
    template:
      - name: extension-checks
        extname: EmailCapture

  - name: mediawiki/extensions/EtherEditor
    template:
      - name: extension-unittests
        extname: EtherEditor

  - name: mediawiki/extensions/EventLogging
    check:
      - mwext-EventLogging-jslint
      - mwext-EventLogging-tox-flake8
      - mwext-EventLogging-lint
    test:
      - mwext-EventLogging-jslint
      - mwext-EventLogging-tox-flake8
      - mwext-EventLogging-tox-py27
      - mwext-EventLogging-lint:
        - mwext-EventLogging-testextensions-master
        - mwext-EventLogging-qunit
    gate-and-submit:
      - mwext-EventLogging-jslint
      - mwext-EventLogging-tox-flake8
      - mwext-EventLogging-tox-py27
      - mwext-EventLogging-lint:
        - mwext-EventLogging-testextensions-master
        - mwext-EventLogging-qunit

  - name: mediawiki/extensions/ExpandTemplates
    template:
      - name: extension-checks
        extname: ExpandTemplates

  - name: mediawiki/extensions/ExtensionDistributor
    template:
      - name: extension-checks
        extname: ExtensionDistributor

  - name: mediawiki/extensions/FeaturedFeeds
    template:
      - name: extension-checks
        extname: FeaturedFeeds

  - name: mediawiki/extensions/FlaggedRevs
    template:
      - name: extension-unittests
        extname: FlaggedRevs

  - name: mediawiki/extensions/Flow
    check:
     - mwext-Flow-jslint
     - mwext-Flow-lint
     - mwext-Flow-ruby1.9.3lint
    test:
     - mwext-Flow-jslint
     - mwext-Flow-lint:
       - mwext-Flow-testextensions-master
     - mwext-Flow-ruby1.9.3lint
    gate-and-submit:
     - mwext-Flow-jslint
     - mwext-Flow-lint:
       - mwext-Flow-testextensions-master
     - mwext-Flow-ruby1.9.3lint

  - name: mediawiki/extensions/FormPreloadPostCache
    template:
      - name: extension-checks
        extname: FormPreloadPostCache

  - name: mediawiki/extensions/FundraiserLandingPage
    template:
      - name: extension-checks
        extname: FundraiserLandingPage

  - name: mediawiki/extensions/Gadgets
    template:
      - name: extension-unittests
        extname: Gadgets

  - name: mediawiki/extensions/GettingStarted
    template:
      - name: extension-unittests
        extname: GettingStarted
    test:
      - mwext-GettingStarted-qunit
    gate-and-submit:
      - mwext-GettingStarted-qunit

  - name: mediawiki/extensions/GeoCrumbs
    template:
      - name: extension-checks
        extname: GeoCrumbs

  - name: mediawiki/extensions/GeoData
    template:
      - name: extension-unittests
        extname: GeoData

  - name: mediawiki/extensions/GeoGebra
    template:
      - name: extension-unittests
        extname: GeoGebra

  - name: mediawiki/extensions/Git2Pages
    template:
      - name: extension-unittests
        extname: Git2Pages

  - name: mediawiki/extensions/GlobalBlocking
    template:
      - name: extension-checks
        extname: GlobalBlocking

  - name: mediawiki/extensions/GlobalCssJs
    template:
      - name: extension-checks
        extname: GlobalCssJs

  - name: mediawiki/extensions/GlobalPreferences
    template:
      - name: extension-unittests
        extname: GlobalPreferences

  - name: mediawiki/extensions/GlobalUsage
    template:
      - name: extension-checks
        extname: GlobalUsage

  - name: mediawiki/extensions/GoogleAdSense
    template:
      - name: extension-checks
        extname: GoogleAdSense

  - name: mediawiki/extensions/GoogleAppEngine
    template:
      - name: extension-unittests
        extname: GoogleAppEngine

  - name: mediawiki/extensions/GoogleCustomWikiSearch
    template:
      - name: extension-checks
        extname: GoogleCustomWikiSearch

  - name: mediawiki/extensions/GoogleNewsSitemap
    template:
      - name: extension-checks
        extname: GoogleNewsSitemap

  - name: mediawiki/extensions/GoogleSiteSearch
    template:
      - name: extension-checks
        extname: GoogleSiteSearch

  - name: mediawiki/extensions/GuidedTour
    check:
     - mwext-GuidedTour-jslint
     - mwext-GuidedTour-lint
    test:
     - mwext-GuidedTour-jslint
     - mwext-GuidedTour-lint:
       - mwext-GuidedTour-testextensions-master
       - mwext-GuidedTour-qunit
     - mwext-GuidedTour-doc-test
    gate-and-submit:
     - mwext-GuidedTour-jslint
     - mwext-GuidedTour-lint:
       - mwext-GuidedTour-testextensions-master
       - mwext-GuidedTour-qunit
     - mwext-GuidedTour-doc-test
    postmerge:
     - mwext-GuidedTour-doc-publish

  - name: mediawiki/extensions/GWToolset
    template:
      - name: extension-unittests
        extname: GWToolset

  - name: mediawiki/extensions/I18nTags
    template:
      - name: extension-checks
        extname: I18nTags

  - name: mediawiki/extensions/ImageMap
    template:
      - name: extension-checks
        extname: ImageMap

  - name: mediawiki/extensions/InputBox
    template:
      - name: extension-checks
        extname: InputBox

  - name: mediawiki/extensions/Insider
    template:
      - name: extension-checks
        extname: Insider

  - name: mediawiki/extensions/Interwiki
    check-only:
      - mwext-Interwiki-phpcs-strict-HEAD # Experiment, bug 48420
      - mwext-Interwiki-jslint
      - mwext-Interwiki-lint
    gate-and-submit:
      - mwext-Interwiki-phpcs-strict-HEAD # Experiment, bug 48420
      - mwext-Interwiki-jslint
      - mwext-Interwiki-lint

  - name: mediawiki/extensions/intersection
    template:
      - name: extension-checks
        extname: intersection

  - name: mediawiki/extensions/JsonConfig
    template:
      - name: extension-unittests
        extname: JsonConfig

  - name: mediawiki/extensions/JsonData
    template:
      - name: extension-unittests
        extname: JsonData

  - name: mediawiki/extensions/LabeledSectionTransclusion
    template:
      - name: extension-unittests
        extname: LabeledSectionTransclusion

  - name: mediawiki/extensions/LandingCheck
    template:
      - name: extension-checks
        extname: LandingCheck

  - name: mediawiki/extensions/LastModified
    template:
      - name: extension-checks
        extname: LastModified

  - name: mediawiki/extensions/LdapAuthentication
    template:
      - name: extension-checks
        extname: LdapAuthentication

  - name: mediawiki/extensions/Lingo
    template:
      - name: extension-checks
        extname: Lingo

  - name: mediawiki/extensions/LinkedWiki
    template:
      - name: extension-checks
        extname: LinkedWiki

  - name: mediawiki/extensions/LiquidThreads
    template:
      - name: extension-checks
        extname: LiquidThreads

  - name: mediawiki/extensions/Listings
    template:
      - name: extension-checks
        extname: Listings

  - name: mediawiki/extensions/LocalisationUpdate
    template:
      - name: extension-checks
        extname: LocalisationUpdate

  - name: mediawiki/extensions/Math
    template:
      - name: extension-unittests
        extname: Math
    postmerge:
      - beta-recompile-math-texvc-eqiad

  - name: mediawiki/extensions/MathSearch
    template:
      - name: extension-unittests
        extname: MathSearch

  - name: mediawiki/extensions/MapSources
    template:
      - name: extension-checks
        extname: MapSources

  - name: mediawiki/extensions/MassMessage
    template:
      - name: extension-unittests
        extname: MassMessage

  - name: mediawiki/extensions/MarkAsHelpful
    template:
      - name: extension-checks
        extname: MarkAsHelpful

  - name: mediawiki/extensions/MobileFrontend
    check:
      - mwext-MobileFrontend-lint
      - mwext-MobileFrontend-jslint
      - mwext-MobileFrontend-ruby1.9.3lint
      - mwext-MobileFrontend-phpcs-HEAD
    test:
      - mwext-MobileFrontend-jslint
      - mwext-MobileFrontend-lint:
        - mwext-MobileFrontend-testextensions-master
      - mwext-MobileFrontend-ruby1.9.3lint
      - mwext-MobileFrontend-phpcs-HEAD
      - mwext-MobileFrontend-qunit
      - mwext-MobileFrontend-qunit-mobile
    gate-and-submit:
      - mwext-MobileFrontend-jslint
      - mwext-MobileFrontend-lint:
        - mwext-MobileFrontend-testextensions-master
      - mwext-MobileFrontend-ruby1.9.3lint
      - mwext-MobileFrontend-phpcs-HEAD
      - mwext-MobileFrontend-qunit
      - mwext-MobileFrontend-qunit-mobile

  - name: mediawiki/extensions/MolHandler
    template:
      - name: extension-unittests
        extname: MolHandler

  - name: mediawiki/extensions/MoodBar
    template:
      - name: extension-checks
        extname: MoodBar

  - name: mediawiki/extensions/MultiMaps
    template:
      - name: extension-unittests
        extname: MultiMaps

  - name: mediawiki/extensions/MultimediaViewer
    check:
      - mwext-MultimediaViewer-lint
      - mwext-MultimediaViewer-jslint
      - mwext-MultimediaViewer-doc-test
    test:
      - mwext-MultimediaViewer-lint
      - mwext-MultimediaViewer-jslint
      - mwext-MultimediaViewer-qunit
      - mwext-MultimediaViewer-doc-test
    gate-and-submit:
      - mwext-MultimediaViewer-lint
      - mwext-MultimediaViewer-jslint
      - mwext-MultimediaViewer-qunit
      - mwext-MultimediaViewer-doc-test
    postmerge:
      - mwext-MultimediaViewer-doc-publish

  - name: mediawiki/extensions/MwEmbedSupport
    template:
      - name: extension-checks
        extname: MwEmbedSupport

  - name: mediawiki/extensions/MWSearch
    template:
      - name: extension-checks
        extname: MWSearch

  # TODO: add qunit
  - name: mediawiki/extensions/Narayam
    template:
      - name: extension-checks
        extname: Narayam

  - name: mediawiki/extensions/NaturalLanguageList
    template:
      - name: extension-unittests
        extname: NaturalLanguageList

  - name: mediawiki/extensions/NavigationTiming
    template:
      - name: extension-checks
        extname: NavigationTiming

  - name: mediawiki/extensions/NewestPages
    template:
      - name: extension-checks
        extname: NewestPages

  - name: mediawiki/extensions/NewUserMessage
    template:
      - name: extension-checks
        extname: NewUserMessage

  - name: mediawiki/extensions/NewUserNotif
    template:
      - name: extension-checks
        extname: NewUserNotif

  - name: mediawiki/extensions/Nonlinear
    template:
      - name: extension-unittests
        extname: Nonlinear

  - name: mediawiki/extensions/Nostalgia
    template:
      - name: extension-checks
        extname: Nostalgia

  - name: mediawiki/extensions/Nuke
    template:
      - name: extension-checks
        extname: Nuke

  - name: mediawiki/extensions/OATHAuth
    template:
      - name: extension-checks
        extname: OATHAuth

  - name: mediawiki/extensions/OAI
    template:
      - name: extension-checks
        extname: OAI

  - name: mediawiki/extensions/OAuth
    template:
      - name: extension-unittests
        extname: OAuth

  - name: mediawiki/extensions/Offline
    check-only:
      - mwext-Offline-jslint
      - mwext-Offline-lint
      - mwext-Offline-pep8
      - mwext-Offline-pyflakes
    gate-and-submit:
      - mwext-Offline-jslint
      - mwext-Offline-lint
      - mwext-Offline-pep8
      - mwext-Offline-pyflakes

  - name: mediawiki/extensions/OggHandler
    template:
      - name: extension-unittests
        extname: OggHandler

  - name: mediawiki/extensions/OpenID
    template:
      - name: extension-checks
        extname: OpenID

  - name: mediawiki/extensions/OpenSearchXml
    template:
      - name: extension-checks
        extname: OpenSearchXml

  - name: mediawiki/extensions/OpenStackManager
    check-only:
      - mwext-OpenStackManager-jslint
      - mwext-OpenStackManager-lint
      - mwext-OpenStackManager-pep8
      - mwext-OpenStackManager-pyflakes
    gate-and-submit:
      - mwext-OpenStackManager-jslint
      - mwext-OpenStackManager-pep8
      - mwext-OpenStackManager-pyflakes
      - mwext-OpenStackManager-lint

  - name: mediawiki/extensions/PagedTiffHandler
    template:
      - name: extension-unittests
        extname: PagedTiffHandler

  - name: mediawiki/extensions/PageImages
    template:
      - name: extension-checks
        extname: PageImages

  - name: mediawiki/extensions/PageTriage
    template:
      - name: extension-unittests
        extname: PageTriage

  - name: mediawiki/extensions/ParserFunctions
    template:
      - name: extension-unittests
        extname: ParserFunctions

  - name: mediawiki/extensions/ParserHooks
    template:
      - name: extension-checks
        extname: ParserHooks

  - name: mediawiki/extensions/Petition
    template:
      - name: extension-unittests
        extname: Petition

  - name: mediawiki/services/cxserver
    check-voter:
      - cxserver-jslint
      - cxserver-npm
    gate-and-submit:
      - cxserver-jslint
      - cxserver-npm

  - name: mediawiki/services/mathoid
    test:
      - mathoidsvc-debian-glue

  - name: mediawiki/services/parsoid
    check:
      - parsoidsvc-jslint
    test:
      - parsoidsvc-jslint
      - parsoidsvc-parse-tool-check
      - parsoidsvc-roundtrip-test-check
      - parsoidsvc-parsertests-run-harder
      - parsoidsvc-php-parsertests
      # non voting:
      - parsoidsvc-source-parse-tool-check
      - parsoidsvc-source-parsertests-run-harder
      - parsoidsvc-source-roundtrip-test-check

    gate-and-submit:
      - parsoidsvc-jslint
      - parsoidsvc-parsertests-run-harder
      - parsoidsvc-php-parsertests
      - experiment-gating-dependencies
    postmerge:
      - beta-parsoid-update-eqiad

  - name: mediawiki/services/parsoid/deploy
    test:
      - parsoidsvc-parsertests-run-harder
      - parsoidsvc-parse-tool-check
      - parsoidsvc-roundtrip-test-check
      - parsoidsvc-debian-glue
      # non voting:
      - parsoidsvc-deploy-parse-tool-check
      - parsoidsvc-deploy-parsertests-run-harder
      - parsoidsvc-deploy-roundtrip-test-check
    gate-and-submit:
      - parsoidsvc-parsertests-run-harder
      - parsoidsvc-parse-tool-check
      - parsoidsvc-roundtrip-test-check
      - experiment-gating-dependencies
    postmerge:
      - beta-parsoid-update-eqiad

  - name: mediawiki/services/rcstream
    check-voter:
      - rcstream-pep8
      - rcstream-pyflakes
    gate-and-submit:
      - rcstream-pep8
      - rcstream-pyflakes

   # SSS: Till we migrate all our WIP and unreviewed patches over
   # to the new repository, let us keep this in place.
   # FIXME use a template
  - name: mediawiki/extensions/Parsoid
    check:
      - mwext-Parsoid-jslint
      - mwext-Parsoid-phpcs-HEAD
    test:
      - mwext-Parsoid-jslint
      - mwext-Parsoid-phpcs-HEAD
    gate-and-submit:
      - mwext-Parsoid-jslint
      - mwext-Parsoid-phpcs-HEAD

  - name: mediawiki/extensions/PdfHandler
    template:
      - name: extension-checks
        extname: PdfHandler

  - name: mediawiki/extensions/PhpTags
    template:
      - name: extension-unittests
        extname: PhpTags

  - name: mediawiki/extensions/PhpTagsFunctions
    template:
      - name: extension-unittests
        extname: PhpTagsFunctions

  - name: mediawiki/extensions/PHPExcel
    template:
      - name: extension-checks
        extname: PHPExcel

  - name: mediawiki/extensions/Poem
    template:
      - name: extension-unittests
        extname: Poem

  - name: mediawiki/extensions/PoolCounter
    check:
      - mwext-PoolCounter-jslint
      - mwext-PoolCounter-lint
    test:
      - mwext-PoolCounter-jslint
      - mwext-PoolCounter-lint
      - mwext-PoolCounter-build
    gate-and-submit:
      - mwext-PoolCounter-jslint
      - mwext-PoolCounter-lint
      - mwext-PoolCounter-build

  - name: mediawiki/extensions/Popups
    template:
      - name: extension-unittests
        extname: Popups

  - name: mediawiki/extensions/PostEdit
    template:
      - name: extension-checks
        extname: PostEdit

  - name: mediawiki/extensions/ProofreadPage
    template:
      - name: extension-unittests
        extname: ProofreadPage

  - name: mediawiki/extensions/Quiz
    template:
      - name: extension-checks
        extname: Quiz

  - name: mediawiki/extensions/RandomRootPage
    template:
      - name: extension-checks
        extname: RandomRootPage

  - name: mediawiki/extensions/ReaderFeedback
    template:
      - name: extension-checks
        extname: ReaderFeedback

  - name: mediawiki/extensions/RelatedArticles
    template:
      - name: extension-checks
        extname: RelatedArticles

  - name: mediawiki/extensions/RelatedSites
    template:
      - name: extension-checks
        extname: RelatedSites

  - name: mediawiki/extensions/Renameuser
    template:
      - name: extension-checks
        extname: Renameuser

  - name: mediawiki/extensions/ReplaceSet
    template:
      - name: extension-unittests
        extname: ReplaceSet

  - name: mediawiki/extensions/ReplaceText
    template:
      - name: extension-checks
        extname: ReplaceText

  - name: mediawiki/extensions/RSS
    template:
      - name: extension-checks
        extname: RSS

  - name: mediawiki/extensions/Score
    template:
      - name: extension-checks
        extname: Score

  - name: mediawiki/extensions/SearchExtraNS
    template:
      - name: extension-checks
        extname: SearchExtraNS

  - name: mediawiki/extensions/SecurePoll
    template:
      - name: extension-checks
        extname: SecurePoll

  - name: mediawiki/extensions/SemanticACL
    template:
      - name: extension-checks
        extname: SemanticACL

  - name: mediawiki/extensions/SemanticBundle
    check-only:
     - mwext-SemanticBundle-jslint
     - mwext-SemanticBundle-lint
     - mwext-SemanticBundle-pep8
     - mwext-SemanticBundle-pyflakes
    gate-and-submit:
     - mwext-SemanticBundle-jslint
     - mwext-SemanticBundle-lint
     - mwext-SemanticBundle-pep8
     - mwext-SemanticBundle-pyflakes

  - name: mediawiki/extensions/SemanticCompoundQueries
    template:
      - name: extension-checks
        extname: SemanticCompoundQueries

  - name: mediawiki/extensions/SemanticDrilldown
    template:
      - name: extension-checks
        extname: SemanticDrilldown

  - name: mediawiki/extensions/SemanticExpressiveness
    template:
      - name: extension-checks
        extname: SemanticExpressiveness

  - name: mediawiki/extensions/SemanticExtraSpecialProperties
    template:
      - name: extension-checks
        extname: SemanticExtraSpecialProperties

  - name: mediawiki/extensions/SemanticForms
    template:
      - name: extension-checks
        extname: SemanticForms

  - name: mediawiki/extensions/SemanticFormsInputs
    template:
      - name: extension-checks
        extname: SemanticFormsInputs

  - name: mediawiki/extensions/SemanticGenealogy
    template:
      - name: extension-checks
        extname: SemanticGenealogy

  - name: mediawiki/extensions/SemanticGlossary
    template:
      - name: extension-checks
        extname: SemanticGlossary

  - name: mediawiki/extensions/SemanticImageAnnotator
    template:
      - name: extension-checks
        extname: SemanticImageAnnotator

  - name: mediawiki/extensions/SemanticImageInput
    template:
      - name: extension-checks
        extname: SemanticImageInput

  - name: mediawiki/extensions/SemanticInternalObjects
    template:
      - name: extension-checks
        extname: SemanticInternalObjects

  - name: mediawiki/extensions/SemanticMaps
    template:
      - name: extension-checks
        extname: SemanticMaps

  - name: mediawiki/extensions/SemanticMediaWiki
    template:
      - name: extension-checks
        extname: SemanticMediaWiki

  - name: mediawiki/extensions/SemanticPageMaker
    template:
      - name: extension-checks
        extname: SemanticPageMaker

  - name: mediawiki/extensions/SemanticPageSeries
    template:
      - name: extension-checks
        extname: SemanticPageSeries

  - name: mediawiki/extensions/SemanticResultFormats
    template:
      - name: extension-checks
        extname: SemanticResultFormats

  - name: mediawiki/extensions/SemanticSignup
    template:
      - name: extension-checks
        extname: SemanticSignup

  - name: mediawiki/extensions/SemanticTasks
    template:
      - name: extension-checks
        extname: SemanticTasks

  - name: mediawiki/extensions/SemanticTitle
    template:
      - name: extension-checks
        extname: SemanticTitle

  - name: mediawiki/extensions/SemanticUpdateOnPurge
    template:
      - name: extension-checks
        extname: SemanticUpdateOnPurge

  - name: mediawiki/extensions/SemanticWatchlist
    template:
      - name: extension-checks
        extname: SemanticWatchlist

  - name: mediawiki/extensions/Scribunto
    template:
      - name: extension-unittests
        extname: Scribunto

  - name: mediawiki/extensions/ShortUrl
    template:
      - name: extension-checks
        extname: ShortUrl

  - name: mediawiki/extensions/SimpleAntiSpam
    template:
      - name: extension-checks
        extname: SimpleAntiSpam

  - name: mediawiki/extensions/SimpleFarm
    template:
      - name: extension-checks
        extname: SimpleFarm

  - name: mediawiki/extensions/SiteMatrix
    template:
      - name: extension-checks
        extname: SiteMatrix

  - name: mediawiki/extensions/SkinPerPage
    template:
      - name: extension-checks
        extname: SkinPerPage

  - name: mediawiki/extensions/skins
    template:
      - name: extension-checks
        extname: skins

  - name: mediawiki/extensions/SlippyMap
    template:
      - name: extension-unittests
        extname: SlippyMap

  - name: mediawiki/extensions/Solarium
    template:
      - name: extension-checks
        extname: Solarium

  - name: mediawiki/extensions/SpamBlacklist
    template:
      - name: extension-checks
        extname: SpamBlacklist

  - name: mediawiki/extensions/Spreadsheet
    template:
      - name: extension-checks
        extname: Spreadsheet

  - name: mediawiki/extensions/StopForumSpam
    template:
      - name: extension-unittests
        extname: StopForumSpam

  - name: mediawiki/extensions/StrategyWiki
    template:
      - name: extension-checks
        extname: StrategyWiki

  - name: mediawiki/extensions/SubPageList3
    template:
      - name: extension-checks
        extname: SubPageList3

  - name: mediawiki/extensions/SubpageSortkey
    template:
      - name: extension-checks
        extname: SubpageSortkey

  - name: mediawiki/extensions/Sudo
    template:
      - name: extension-checks
        extname: Sudo

  - name: mediawiki/extensions/Survey
    template:
      - name: extension-unittests
        extname: Survey

  - name: mediawiki/extensions/SVGEdit
    template:
      - name: extension-checks
        extname: SVGEdit

  - name: mediawiki/extensions/SwiftCloudFiles
    template:
      - name: extension-checks
        extname: SwiftCloudFiles

  - name: mediawiki/extensions/TemplateSandbox
    template:
      - name: extension-checks
        extname: TemplateSandbox

  - name: mediawiki/extensions/TextExtracts
    template:
      - name: extension-unittests
        extname: TextExtracts

  - name: mediawiki/extensions/SideBarMenu
    template:
      - name: extension-unittests
        extname: SideBarMenu

  - name: mediawiki/extensions/SyntaxHighlight_GeSHi
    check-only:
      - mwext-SyntaxHighlight_GeSHi-jslint
      - mwext-SyntaxHighlight_GeSHi-phpcs-HEAD
      - mwext-SyntaxHighlight_GeSHi-lint
    gate-and-submit:
      - mwext-SyntaxHighlight_GeSHi-jslint
      - mwext-SyntaxHighlight_GeSHi-phpcs-HEAD
      - mwext-SyntaxHighlight_GeSHi-lint

  - name: mediawiki/extensions/TemplateData
    check:
      - mwext-TemplateData-lint
      - mwext-TemplateData-jslint
      - mwext-TemplateData-phpcs-HEAD
    test:
      - mwext-TemplateData-lint
      - mwext-TemplateData-jslint
      - mwext-TemplateData-qunit
      - mwext-TemplateData-testextensions-master
      - mwext-TemplateData-phpcs-HEAD
    gate-and-submit:
      - mwext-TemplateData-lint
      - mwext-TemplateData-jslint
      - mwext-TemplateData-qunit
      - mwext-TemplateData-testextensions-master
      - mwext-TemplateData-phpcs-HEAD

  - name: mediawiki/extensions/Thanks
    template:
      - name: extension-unittests
        extname: Thanks

  - name: mediawiki/extensions/TimedMediaHandler
    template:
      - name: extension-unittests
        extname: TimedMediaHandler

  - name: mediawiki/extensions/timeline
    check-only:
     - mwext-timeline-lint
     - mwext-timeline-perllint
    gate-and-submit:
     - mwext-timeline-lint
     - mwext-timeline-perllint

  - name: mediawiki/extensions/TitleBlacklist
    template:
      - name: extension-unittests
        extname: TitleBlacklist

  - name: mediawiki/extensions/TitleKey
    template:
      - name: extension-checks
        extname: TitleKey

  - name: mediawiki/extensions/TocTree
    template:
      - name: extension-checks
        extname: TocTree

  - name: mediawiki/extensions/TorBlock
    template:
      - name: extension-checks
        extname: TorBlock

  - name: mediawiki/extensions/Translate
    check:
      - mwext-Translate-phpcs-strict-HEAD  # Experiment, bug 48420
      - mwext-Translate-jslint
      - mwext-Translate-lint
      - mwext-Translate-ruby1.9.3lint
    test:
      - mwext-Translate-phpcs-strict-HEAD  # Experiment, bug 48420
      - mwext-Translate-jslint
      - mwext-Translate-lint:
        - mwext-Translate-testextensions-master
      - mwext-Translate-ruby1.9.3lint
    gate-and-submit:
      - mwext-Translate-phpcs-strict # Experiment for bug 48420
      - mwext-Translate-jslint
      - mwext-Translate-lint:
        - mwext-Translate-testextensions-master
      - mwext-Translate-ruby1.9.3lint

  - name: mediawiki/extensions/TranslationNotifications
    check:
      - mwext-TranslationNotifications-phpcs-strict-HEAD # Experiment, bug 48420
      - mwext-TranslationNotifications-jslint
      - mwext-TranslationNotifications-lint
    test:
      - mwext-TranslationNotifications-phpcs-strict-HEAD # Experiment, bug 48420
      - mwext-TranslationNotifications-jslint
      - mwext-TranslationNotifications-lint:
        - mwext-TranslationNotifications-testextensions-master
    gate-and-submit:
      - mwext-TranslationNotifications-phpcs-strict-HEAD # Experiment, bug 48420
      - mwext-TranslationNotifications-jslint
      - mwext-TranslationNotifications-lint:
        - mwext-TranslationNotifications-testextensions-master

  - name: mediawiki/extensions/Transliterator
    template:
      - name: extension-unittests
        extname: Transliterator

  - name: mediawiki/extensions/TrustedXFF
    template:
      - name: extension-checks
        extname: TrustedXFF

  - name: mediawiki/extensions/TwnMainPage
    check:
      - mwext-TwnMainPage-jslint
      - mwext-TwnMainPage-lint
      - mwext-TwnMainPage-phpcs-strict-HEAD # Experiment, bug 48420
      - mwext-TwnMainPage-ruby1.9.3lint
    test:
      - mwext-TwnMainPage-jslint
      - mwext-TwnMainPage-phpcs-strict-HEAD # Experiment, bug 48420
      - mwext-TwnMainPage-lint:
        - mwext-TwnMainPage-testextensions-master
      - mwext-TwnMainPage-ruby1.9.3lint
    gate-and-submit:
      - mwext-TwnMainPage-jslint
      - mwext-TwnMainPage-phpcs-strict-HEAD # Experiment, bug 48420
      - mwext-TwnMainPage-lint:
        - mwext-TwnMainPage-testextensions-master
      - mwext-TwnMainPage-ruby1.9.3lint

  - name: mediawiki/extensions/TwoFactorAuthentication
    template:
      - name: extension-unittests
        extname: TwoFactorAuthentication

  - name: mediawiki/extensions/Persona
    template:
      - name: extension-unittests
        extname: Persona

  - name: mediawiki/extensions/OpenBadges
    template:
      - name: extension-unittests
        extname: OpenBadges

  - name: mediawiki/extensions/UnicodeConverter
    template:
      - name: extension-checks
        extname: UnicodeConverter

  - name: mediawiki/extensions/UniversalLanguageSelector
    check:
      - mwext-UniversalLanguageSelector-lint
      - mwext-UniversalLanguageSelector-phpcs-strict-HEAD # Experiment, bug 48420
      - mwext-UniversalLanguageSelector-jslint
      - mwext-UniversalLanguageSelector-ruby1.9.3lint
    test:
      - mwext-UniversalLanguageSelector-phpcs-strict-HEAD # Experiment, bug 48420
      - mwext-UniversalLanguageSelector-jslint
      - mwext-UniversalLanguageSelector-lint:
        - mwext-UniversalLanguageSelector-testextensions-master
      - mwext-UniversalLanguageSelector-ruby1.9.3lint
      - mwext-browsertests-UniversalLanguageSelector-phantomjs  # Experiment, bug 52120
    gate-and-submit:
      - mwext-UniversalLanguageSelector-phpcs-strict-HEAD # Experiment, bug 48420
      - mwext-UniversalLanguageSelector-jslint
      - mwext-UniversalLanguageSelector-lint:
        - mwext-UniversalLanguageSelector-testextensions-master
      - mwext-UniversalLanguageSelector-ruby1.9.3lint

  - name: mediawiki/extensions/UploadBlacklist
    template:
      - name: extension-checks
        extname: UploadBlacklist

  - name: mediawiki/extensions/UploadWizard
    check:
      - mwext-UploadWizard-jslint
      - mwext-UploadWizard-phpcs-HEAD
      - mwext-UploadWizard-lint
      - mwext-UploadWizard-pep8
      - mwext-UploadWizard-pyflakes
    test:
      - mwext-UploadWizard-jslint
      - mwext-UploadWizard-qunit
      - mwext-UploadWizard-phpcs-HEAD
      - mwext-UploadWizard-lint:
        - mwext-UploadWizard-testextensions-master
      - mwext-UploadWizard-pep8
      - mwext-UploadWizard-pyflakes
    gate-and-submit:
      - mwext-UploadWizard-jslint
      - mwext-UploadWizard-qunit
      - mwext-UploadWizard-phpcs-HEAD
      - mwext-UploadWizard-lint:
        - mwext-UploadWizard-testextensions-master
      - mwext-UploadWizard-pep8
      - mwext-UploadWizard-pyflakes

  - name: mediawiki/extensions/UserDailyContribs
    template:
      - name: extension-checks
        extname: UserDailyContribs

  - name: mediawiki/extensions/UserMerge
    template:
      - name: extension-checks
        extname: UserMerge

  - name: mediawiki/extensions/UserOptionStats
    template:
      - name: extension-checks
        extname: UserOptionStats

  - name: mediawiki/extensions/UserThrottle
    template:
      - name: extension-checks
        extname: UserThrottle

  - name: mediawiki/extensions/Validator
    template:
      - name: extension-unittests
        extname: Validator

  - name: mediawiki/extensions/Variables
    template:
      - name: extension-unittests
        extname: Variables

  - name: mediawiki/extensions/Vector
    check-only:
      - mwext-Vector-jslint
      - mwext-Vector-phpcs-HEAD
      - mwext-Vector-lint
    gate-and-submit:
      - mwext-Vector-jslint
      - mwext-Vector-phpcs-HEAD
      - mwext-Vector-lint

  - name: mediawiki/extensions/VectorBeta
    template:
      - name: extension-unittests
        extname: VectorBeta

  - name: mediawiki/extensions/VipsScaler
    template:
      - name: extension-checks
        extname: VipsScaler

  - name: mediawiki/extensions/VisualEditor
    check:
      - mwext-VisualEditor-jslint
      - mwext-VisualEditor-lint
      - mwext-VisualEditor-ruby1.9.3lint
      - mwext-VisualEditor-phpcs-HEAD
    test:
      - mwext-VisualEditor-npm
      - mwext-VisualEditor-lint
      - mwext-VisualEditor-ruby1.9.3lint
      - mwext-VisualEditor-phpcs-HEAD
      - mwext-VisualEditor-doc-test
      - mwext-VisualEditor-qunit
    gate-and-submit:
      - mwext-VisualEditor-npm
      - mwext-VisualEditor-lint
      - mwext-VisualEditor-ruby1.9.3lint
      - mwext-VisualEditor-phpcs-HEAD
      - mwext-VisualEditor-doc-test
      - mwext-VisualEditor-qunit
      - experiment-gating-dependencies
    postmerge:
      - mwext-VisualEditor-doc-publish
      - mwext-VisualEditor-sync-gerrit

  - name: mediawiki/extensions/WebChat
    template:
      - name: extension-checks
        extname: WebChat

  - name: mediawiki/extensions/WebFonts
    check-only:
      - mwext-WebFonts-jslint
      - mwext-WebFonts-phpcs-HEAD
      - mwext-WebFonts-lint
    gate-and-submit:
      - mwext-WebFonts-jslint
      - mwext-WebFonts-phpcs-HEAD
      - mwext-WebFonts-lint

  - name: mediawiki/extensions/WikiEditor
    check-only:
      - mwext-WikiEditor-jslint
      - mwext-WikiEditor-phpcs-HEAD
      - mwext-WikiEditor-lint
    gate-and-submit:
      - mwext-WikiEditor-jslint
      - mwext-WikiEditor-phpcs-HEAD
      - mwext-WikiEditor-lint

  - name: mediawiki/extensions/Wikibase
    check-only:
      - mwext-Wikibase-jslint
      - mwext-Wikibase-ruby1.9.3lint
      - mwext-Wikibase-lint
    gate-and-submit:
      - mwext-Wikibase-jslint
      - mwext-Wikibase-ruby1.9.3lint
      - mwext-Wikibase-lint

  - name: mediawiki/extensions/WikibaseQueryEngine
    template:
      - name: extension-checks
        extname: WikibaseQueryEngine

  - name: mediawiki/extensions/WikibaseQuery
    template:
      - name: extension-checks
        extname: WikibaseQuery

  - name: mediawiki/extensions/Wikidata
    template:
      - name: extension-unittests
        extname: Wikidata

  - name: mediawiki/extensions/WikiForum
    template:
      - name: extension-checks
        extname: WikiForum

  - name: mediawiki/extensions/WikiLexicalData
    template:
      - name: extension-checks
        extname: WikiLexicalData

  - name: mediawiki/extensions/WikiLove
    template:
      - name: extension-checks
        extname: WikiLove

  - name: mediawiki/extensions/wikihiero
    template:
      - name: extension-unittests
        extname: wikihiero

  - name: mediawiki/extensions/WikimediaIncubator
    template:
      - name: extension-checks
        extname: WikimediaIncubator

  - name: mediawiki/extensions/WikimediaMaintenance
    template:
      - name: extension-checks
        extname: WikimediaMaintenance

  - name: mediawiki/extensions/WikimediaMessages
    template:
      - name: extension-checks
        extname: WikimediaMessages

  - name: mediawiki/extensions/WikimediaShopLink
    template:
      - name: extension-checks
        extname: WikimediaShopLink

  - name: mediawiki/extensions/WikiObjectModel
    template:
      - name: extension-checks
        extname: WikiObjectModel

  - name: mediawiki/extensions/Workflow
    check:
      - mwext-Workflow-jslint
      - mwext-Workflow-lint
      - mwext-Workflow-yamllint
    test: &mwext-Workflow-all-test-jobs
      - mwext-Workflow-jslint
      - mwext-Workflow-lint:
        - mwext-Workflow-testextensions-master
      - mwext-Workflow-yamllint
    gate-and-submit:
      *mwext-Workflow-all-test-jobs

  - name: mediawiki/extensions/ZeroRatedMobileAccess
    template:
      - name: extension-unittests
        extname: ZeroRatedMobileAccess

#### PHP Extensions ###################################################

  - name: mediawiki/php/FastStringSearch
    # no check pipeline since -build runs code :-)
    test:
      - php-FastStringSearch-build
    gate-and-submit:
      - php-FastStringSearch-build

  - name: mediawiki/php/luasandbox
    # no check pipeline since -build runs code :-)
    test:
      - php-luasandbox-build
    gate-and-submit:
      - php-luasandbox-build

  - name: mediawiki/php/NativePreprocessor
    # no check pipeline since -build runs code :-)
    test:
      - php-NativePreprocessor-build
    gate-and-submit:
      - php-NativePreprocessor-build

  - name: mediawiki/php/wikidiff
    # no check pipeline since -build runs code :-)
    test:
      - php-wikidiff-build
    gate-and-submit:
      - php-wikidiff-build

  - name: mediawiki/php/wikidiff2
    # no check pipeline since -build runs code :-)
    test:
      - php-wikidiff2-build
    gate-and-submit:
      - php-wikidiff2-build

  - name: mediawiki/php/wmerrors
    # no check pipeline since -build runs code :-)
    test:
      - php-wmerrors-build
    gate-and-submit:
      - php-wmerrors-build

  - name: pywikibot/compat
    template:
      - name: 'python-lint'
        prefix: 'pywikibot-compat'

  - name: pywikibot/core
    check:
      - 'pywikibot-core-pep8'
      - 'pywikibot-core-pyflakes'
    test:
      - 'pywikibot-core-pep8'
      - 'pywikibot-core-pyflakes'
      - 'pywikibot-core-tox-flake8'
    gate-and-submit:
      - 'pywikibot-core-pep8'
      - 'pywikibot-core-pyflakes'
      - 'pywikibot-core-tox-flake8'

  - name: pywikibot/i18n
    template:
      - name: 'python-lint'
        prefix: 'pywikibot-i18n'

  - name: qa/browsertests
    check:
      - qa-browsertests-ruby1.9.3lint
    test:
      - qa-browsertests-ruby1.9.3lint
      - qa-browsertests-build
    gate-and-submit:
      - qa-browsertests-ruby1.9.3lint
      - qa-browsertests-build
    postmerge:
      - qa-browsertests-postmerge

  - name: qrpedia
    check-voter:
      - qrpedia-phplint
    gate-and-submit:
      - qrpedia-phplint

  - name: sartoris
    template:
      - name: 'python'
        prefix: 'sartoris'

  - name: search/highlighter
    test:
      - search-highlighter
    gate-and-submit:
      - search-highlighter

  - name: oojs/core
    check:
      - oojs-core-jslint
    test:
      - oojs-core-npm
      - oojs-core-jsduck
    gate-and-submit:
      - oojs-core-npm
      - oojs-core-jsduck
    postmerge:
      - oojs-core-jsduck-publish

  - name: oojs/ui
    check:
      - oojs-ui-jslint
    test:
      - oojs-ui-npm
      - oojs-ui-jsduck
    gate-and-submit:
      - oojs-ui-npm
      - oojs-ui-jsduck
    postmerge:
      - oojs-ui-jsduck-publish

  - name: VisualEditor/VisualEditor
    check:
      - VisualEditor-jslint
      - VisualEditor-ruby1.9.3lint
    test:
      - VisualEditor-npm
      - VisualEditor-ruby1.9.3lint
      - VisualEditor-jsduck
    gate-and-submit:
      - VisualEditor-npm
      - VisualEditor-ruby1.9.3lint
      - VisualEditor-jsduck
