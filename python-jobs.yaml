# Invoke a tox environement
# Parameter: {toxenv}
- job-template:
    name: '{name}-tox-{toxenv}'
    node: contintLabsSlave
    defaults: use-remote-zuul
    triggers:
     - zuul
    builders:
     - tox:
         venv: '{toxenv}'
    publishers:
     - archive-log-dir

- job-template:
    name: '{name}-tox-doc-publish'
    node: contintLabsSlave
    defaults: use-remote-zuul
    triggers:
     - zuul
    builders:
     - tox:
         venv: doc
    publishers:
     - archive-log-dir
     - copy-to-master:
         includes:
           - 'html/**,**/html/**'
         destination: '/srv/org/wikimedia/doc/{name}'

- job-template:
    name: '{name}-sphinx-doc'
    node: hasContintPackages
    defaults: use-remote-zuul
    triggers:
     - zuul
    builders:
     - shell: "python setup.py build_sphinx"

    # FIXME: should publish somewhere

- job-template:
    name: '{name}-pep8'
    node: hasContintPackages
    defaults: use-remote-zuul
    concurrent: true
    triggers:
     - zuul
    scm:
     - git-remote-zuul-no-submodules
    builders:
     - pep8
    publishers:
     - pep8

- job-template:
    name: '{name}-pyflakes'
    node: hasContintPackages
    defaults: use-remote-zuul
    concurrent: true
    triggers:
     - zuul
    scm:
     - git-remote-zuul-no-submodules
    builders:
     - pyflakes

- job-group:
    name: python-jobs
    jobs:
     - '{name}-sphinx-doc'
     - '{name}-pep8'
     - '{name}-pyflakes'
